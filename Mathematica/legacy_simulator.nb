(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     84301,       2149]
NotebookOptionsPosition[     80812,       2096]
NotebookOutlinePosition[     81220,       2112]
CellTagsIndexPosition[     81177,       2109]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"::", "Package", "::"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
    "SetDirectory", "[", 
     "\"\<C:\\\\Users\\\\heikkie13\\\\Work\\\\howard_scratches\\\\Mathematica\
\>\"", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"<<", "libs/FunctionsComplexAnalysis.m"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"<<", "libs/FunctionsMatrixAnalysis.m"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"<<", "libs/FunctionsFiniteGroups.m"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"<<", "libs/FunctionsGF2.m"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"<<", "libs/FunctionsForExtraSpeciality.m"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "This", " ", "is", " ", "needed", " ", "for", " ", "the", " ", "unitary", 
     " ", "reps", " ", "of", " ", "symplectivc", " ", 
     RowBox[{"matrices", ":"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"<<", "\"\<SymplecticBinary.m\>\""}], ";"}], "*)"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", "AllBinMats", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"dB", "=", 
     RowBox[{
      RowBox[{"10", "*", 
       RowBox[{"Log", "[", 
        RowBox[{"10", ",", 
         RowBox[{"N", "[", "#", "]"}]}], "]"}]}], "&"}]}], ";"}], "\n", 
   RowBox[{"Clear", "[", 
    RowBox[{"mm", ",", "rr"}], "]"}], "\[IndentingNewLine]", "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "These", " ", "are", " ", "needed", " ", "for", " ", "functions", " ", 
     "to", " ", "work", " ", "properly"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "The", " ", "dimension", " ", "for", " ", "the", " ", "simulation", " ", 
      "must", " ", "be", " ", "chosen", " ", "here"}], ",", 
     RowBox[{
     "as", " ", "multiple", " ", "data", " ", "structures", " ", "neede", " ",
       "by", " ", "decoders", " ", "etc", " ", "depend", " ", "on", " ", 
      "m"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mm", "=", "3"}], ";", 
    RowBox[{"Nn", "=", 
     RowBox[{"2", "^", "mm"}]}], ";", 
    RowBox[{"InxBin", "=", 
     RowBox[{"Tuples", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", "mm", "}"}]}], "]"}]}], ";", 
    RowBox[{"WHn", "=", 
     RowBox[{
      RowBox[{"WHmatrix", "[", "Nn", "]"}], "/", 
      RowBox[{"Sqrt", "[", "Nn", "]"}]}]}], ";", 
    RowBox[{"InitializeVeryBare", "[", "mm", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"Evaluate", "[", 
      RowBox[{"Sequence", "@@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"\"\<a\>\"", "<>", 
          RowBox[{"ToString", "[", "kk", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"kk", ",", "1", ",", "mm"}], "}"}]}], "]"}]}], "]"}], "]"}],
     ";"}], "\n", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"Evaluate", "[", 
      RowBox[{"Sequence", "@@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"\"\<b\>\"", "<>", 
          RowBox[{"ToString", "[", "kk", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"kk", ",", "1", ",", "mm"}], "}"}]}], "]"}]}], "]"}], "]"}],
     ";"}], "\n", 
   RowBox[{
    RowBox[{"avec", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ToExpression", "[", 
        RowBox[{"\"\<a\>\"", "<>", 
         RowBox[{"ToString", "[", "kk", "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"kk", ",", "1", ",", "mm"}], "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"bvec", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ToExpression", "[", 
        RowBox[{"\"\<b\>\"", "<>", 
         RowBox[{"ToString", "[", "kk", "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"kk", ",", "1", ",", "mm"}], "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"BitVec", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ToExpression", "[", 
        RowBox[{"\"\<b\>\"", "<>", 
         RowBox[{"ToString", "[", "kk", "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"kk", ",", "1", ",", "mm"}], "}"}]}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"All", " ", "P"}], "-", 
     RowBox[{"matrices", " ", "for", " ", "different", " ", "ranks"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PmatSets", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ComplementedBinarySubspaces", "[", 
        RowBox[{"mm", ",", "rr"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"rr", ",", "0", ",", "mm"}], "}"}]}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"PmatSets", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "//", "mfl"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"PmatInvSets", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Inverse", "[", 
          RowBox[{"#", ",", 
           RowBox[{"Modulus", "->", "2"}]}], "]"}], "&"}], "/@", 
        RowBox[{"ComplementedBinarySubspaces", "[", 
         RowBox[{"mm", ",", "rr"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"rr", ",", "0", ",", "mm"}], "}"}]}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"PmatInvSets", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "//", "mfl"}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"the", " ", "binary", " ", "Grassmann", " ", "dimensions"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"BinGrassDims", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"QBinomial", "[", 
       RowBox[{"mm", ",", "#", ",", "2"}], "]"}], "&"}], "/@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"mm", "+", "1"}], "]"}], "-", "1"}], ")"}]}]}], "\n", 
   RowBox[{"Plus", "@@", "BinGrassDims"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "These", " ", "indicate", " ", "the", " ", "Schubert", " ", "cell"}], 
     ",", 
     RowBox[{"for", " ", "each", " ", "rank"}], ",", 
     RowBox[{
      RowBox[{
      "the", " ", "position", " ", "of", " ", "the", " ", "first", " ", 
       "non"}], "-", 
      RowBox[{
      "zero", " ", "element", " ", "in", " ", "the", " ", "r", " ", "first", 
       " ", "rows"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BitInxs", "=", 
     RowBox[{"Range", "[", "mm", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"CellBitsAllRanks", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Subsets", "[", 
        RowBox[{"BitInxs", ",", 
         RowBox[{"{", "#", "}"}]}], "]"}], "&"}], "/@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"mm", "+", "1"}], "]"}], "-", "1"}], ")"}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Preparing", " ", "the", " ", "indexing", " ", "of", " ", "all", " ", 
     "different", " ", "matrices"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"MatricesPerRank", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"QBinomial", "[", 
        RowBox[{"mm", ",", "rr", ",", "2"}], "]"}], "*", 
       RowBox[{"2", "^", 
        RowBox[{"(", 
         RowBox[{"rr", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"rr", "+", "1"}], ")"}], "/", "2"}]}], ")"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"rr", ",", "0", ",", "mm"}], "}"}]}], "]"}]}], "\n", 
   RowBox[{
    RowBox[{"tmp", "=", "0"}], ";", 
    RowBox[{"MatThresh", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"AddTo", "[", 
        RowBox[{"tmp", ",", "#"}], "]"}], "&"}], "/@", "MatricesPerRank"}]}], 
    ";", 
    RowBox[{"MatThreshAll", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", "MatThresh"}], "]"}]}], ";", 
    RowBox[{"(*", 
     RowBox[{
     "this", " ", "is", " ", "the", " ", "total", " ", "number", " ", "of", 
      " ", "matrices"}], "*)"}], 
    RowBox[{"Nmats", "=", 
     RowBox[{"Plus", "@@", "MatricesPerRank"}]}], ";", 
    RowBox[{"{", 
     RowBox[{"Nmats", ",", 
      RowBox[{"MatThreshAll", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}]}], "\n", 
   RowBox[{
    RowBox[{"MatThresh", "=", 
     RowBox[{"Drop", "[", 
      RowBox[{"MatThreshAll", ",", 
       RowBox[{"-", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "The", " ", "number", " ", "of", " ", "matrices", " ", "of", " ", "given",
      " ", "rank", " ", "for", " ", "all", " ", "possible", " ", "index", " ",
      "values", " ", "is", " ", "correct"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Tally", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MatInx", "=", "#"}], ";", 
          RowBox[{"rr", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"Position", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"MatInx", ">", "#"}], "&"}], "/@", "MatThresh"}], 
                ",", "True"}], "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}], "-", "1"}]}]}], ")"}], "&"}], 
       "/@", 
       RowBox[{"Range", "[", "Nmats", "]"}]}], "]"}], ";"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"CWsTot", "=", 
    RowBox[{"Nn", "*", "Nmats"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"possible", " ", 
     RowBox[{"codewords", "/", "number"}], " ", "of", " ", "bits"}], "*)"}], 
   "\n", 
   RowBox[{"Rate", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Log", "[", 
       RowBox[{"2", ",", "CWsTot"}], "]"}], "/", "Nn"}], "//", "N"}]}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"ZeroVecm", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", "mm", "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"IntegerDigits", "[", 
      RowBox[{
       RowBox[{"#", "-", "1"}], ",", "2", ",", "mm"}], "]"}], "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"2", "^", "mm"}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "all", " ", "Pauli", " ", "matrices", " ", "are", " ", "constructed", 
       " ", "from", " ", "all", " ", "combinations", " ", "of", " ", "an", 
       " ", "a"}], "-", 
      RowBox[{"vec", " ", "and", " ", "a", " ", "b"}], "-", "vec"}], ",", 
     RowBox[{
      RowBox[{"each", " ", "a", " ", "m"}], "-", 
      RowBox[{"dim", " ", "binary", " ", "vector"}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"tups", "=", 
     RowBox[{"Tuples", "[", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"2", "^", "mm"}], "]"}], ",", "2"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "the", " ", "first", " ", "index", " ", "gives", " ", "the", " ", 
       "binary", " ", "a"}], "-", "vector"}], ",", 
     RowBox[{
      RowBox[{"the", " ", "second", " ", "the", " ", "binary", " ", "b"}], 
      "-", "vector"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"AllPaulis", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"avec", "=", 
          RowBox[{"IntegerDigits", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], ",", "2", ",", 
            "mm"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"bvec", "=", 
          RowBox[{"IntegerDigits", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", "1"}], ",", "2", ",", 
            "mm"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"MakePauli", "[", 
          RowBox[{"avec", ",", "bvec"}], "]"}]}], ")"}], "&"}], "/@", 
      "tups"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"AllPaulis", "//", "mfl"}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"Length", "[", "AllPaulis", "]"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"the", " ", "corresponding", " ", "2", "m"}], "-", 
     RowBox[{"dimensional", " ", "binary", " ", 
      RowBox[{"vectors", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"abvecs", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"avec", "=", 
          RowBox[{"IntegerDigits", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], ",", "2", ",", 
            "mm"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"bvec", "=", 
          RowBox[{"IntegerDigits", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", "1"}], ",", "2", ",", 
            "mm"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Join", "[", 
          RowBox[{"avec", ",", "bvec"}], "]"}]}], ")"}], "&"}], "/@", 
      "tups"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"These", " ", "are", " ", "just", " ", "the", " ", "binary", " ", 
      RowBox[{"numbers", "[", 
       RowBox[{"1", ",", 
        RowBox[{"...", " ", "Nn"}]}], "]"}]}], "-", "1"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"abvecs", "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"IntegerDigits", "[", 
          RowBox[{
           RowBox[{"#", "-", "1"}], ",", "2", ",", 
           RowBox[{"2", "mm"}]}], "]"}], "&"}], "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"Nn", "^", "2"}], "]"}]}], ")"}]}], "//", "Flatten"}], "//", 
    "Union"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"these", " ", "constitute", " ", "a", " ", "Frobenius"}], "-", 
     RowBox[{
     "orthogonal", " ", "complete", " ", "basis", " ", "for", " ", "complex", 
      " ", 
      RowBox[{"2", "^", "m"}], " ", "x", " ", 
      RowBox[{"2", "^", "m"}], " ", "matrices"}], "-", 
     RowBox[{
     "Inner", " ", "product", " ", "matrix", " ", "is", " ", "proportional", 
      " ", "to", " ", "identity"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"first", "=", 
            RowBox[{"ConjugateTranspose", "[", "#", "]"}]}], ";", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Tr", "[", 
               RowBox[{"first", ".", "#"}], "]"}], "/", 
              RowBox[{"2", "^", "mm"}]}], "&"}], "/@", "AllPaulis"}]}], ")"}],
          "&"}], "/@", "AllPaulis"}], ")"}], "-", 
      RowBox[{"IdentityMatrix", "[", 
       RowBox[{"Nn", "^", "2"}], "]"}]}], "//", "Flatten"}], "//", "Union"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"All", " ", "are", " ", "Hermitian"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"#", "-", 
         RowBox[{"ConjugateTranspose", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
      "AllPaulis"}], "//", "Flatten"}], "//", "Union"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"All", " ", "are", " ", "unitary"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"#", ".", 
          RowBox[{"ConjugateTranspose", "[", "#", "]"}]}], "-", 
         RowBox[{"IdentityMatrix", "[", "Nn", "]"}]}], ")"}], "&"}], "/@", 
      "AllPaulis"}], "//", "Flatten"}], "//", "Union"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Generate", " ", "a", " ", "set", " ", "of", " ", "projection", " ", 
     "matrices", " ", "from", " ", "the", " ", 
     RowBox[{"Paulis", ".", "These"}], " ", "are", " ", "projections", " ", 
     "as", " ", "the", " ", "Paulis", " ", "are", " ", "involutions"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{"AllProjectors", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"unitN", "+", "#"}], ")"}], "/", "2"}], "&"}], "/@", 
      "AllPaulis"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"#", ".", "#"}], "-", "#"}], ")"}], "&"}], "/@", 
      "AllProjectors"}], "//", "Flatten"}], "//", "Union"}], 
   "\[IndentingNewLine]", "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Generate", " ", "a", " ", "set", " ", "of", " ", "unitary", " ", 
     "matrices", " ", "from", " ", "the", " ", "Paulis"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "These", " ", "are", " ", "Clifford", " ", "group", " ", "elemetns"}], 
     ",", 
     RowBox[{"and", " ", "genererate", " ", "Clifford"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AllTransvecs", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"unitN", "+", 
          RowBox[{"I", "*", "#"}]}], ")"}], "/", 
        RowBox[{"Sqrt", "[", "2", "]"}]}], "&"}], "/@", "AllPaulis"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"these", " ", "are", " ", "indeed", " ", "unitary"}], "*)"}], 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"ConjugateTranspose", "[", "#", "]"}], ".", "#"}], "-", 
         "unitN"}], ")"}], "&"}], "/@", "AllTransvecs"}], "//", "Flatten"}], "//",
     "Union"}], "\n", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MakeUnitaryFromSymmetric", "=", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Sint", ",", "cvec", ",", "dvec", ",", "Ord2"}], "}"}], ",", 
        RowBox[{
         RowBox[{"Sint", "=", "#"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"cvec", "=", 
              RowBox[{"IntegerDigits", "[", 
               RowBox[{
                RowBox[{"#", "-", "1"}], ",", "2", ",", "mm"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Ord2", "=", 
              RowBox[{"cvec", ".", "Sint", ".", "cvec"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"dvec", "=", 
                  RowBox[{"IntegerDigits", "[", 
                   RowBox[{
                    RowBox[{"#", "-", "1"}], ",", "2", ",", "mm"}], "]"}]}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"I", "^", 
                   RowBox[{"(", 
                    RowBox[{"Ord2", "+", 
                    RowBox[{"2", " ", 
                    RowBox[{"dvec", ".", "cvec"}]}]}], ")"}]}], "/", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"2", "^", "mm"}], "]"}]}]}], ")"}], "&"}], "/@", 
              RowBox[{"Range", "[", 
               RowBox[{"2", "^", "mm"}], "]"}]}]}], ")"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"2", "^", "mm"}], "]"}]}]}]}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"all", " ", "symmetric", " ", "m", " ", "x", " ", "m", " ", 
     RowBox[{"matrices", ".", "This"}], " ", "function", " ", "is", " ", "in",
      " ", "\"\<FunctionsGF2\>\""}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"AllBinSymm", "=", 
     RowBox[{"GenerateSn2", "[", "mm", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"AllUmats", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"MakeUnitaryFromSymmetric", "[", "#", "]"}], "&"}], "/@", 
      "AllBinSymm"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CB", "=", 
     RowBox[{"Transpose", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Sequence", "@@", 
         RowBox[{"(", 
          RowBox[{"Transpose", "[", "#", "]"}], ")"}]}], "&"}], "/@", 
       "AllUmats"}], "]"}]}], ";", 
    RowBox[{"card", "=", 
     RowBox[{"Length", "[", 
      RowBox[{"CB", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Length", "[", "AllUmats", "]"}], ",", "card"}], "}"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "The", " ", "permutations", " ", "realizing", " ", "the", " ", "Howard", 
      " ", "shits", " ", "are", " ", "just", " ", "the", " ", "X"}], "-", 
     RowBox[{
     "matrix", " ", "acting", " ", "in", " ", "tensor", " ", "dimension", " ",
       "k"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"PermMatEShifts", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"TensorMany", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"unit2", ",", 
            RowBox[{"{", "#", "}"}]}], "]"}], ",", 
          RowBox[{"{", "sigx", "}"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"unit2", ",", 
            RowBox[{"{", 
             RowBox[{"mm", "-", "1", "-", "#"}], "}"}]}], "]"}]}], "]"}], 
        "]"}], "&"}], "/@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Range", "[", "mm", "]"}], "-", "1"}], ")"}]}]}], ";", 
    RowBox[{"PermMatEShifts", "//", "mfl"}]}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"The", " ", "X"}], "-", 
     RowBox[{
     "matrix", " ", "acting", " ", "in", " ", "the", " ", "first", " ", 
      "tensor", " ", "dimension"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"inx", "=", "#"}], ";", 
        RowBox[{"avec", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", "mm", "}"}]}], "]"}]}], ";", 
        RowBox[{
         RowBox[{"avec", "[", 
          RowBox[{"[", "inx", "]"}], "]"}], "=", "1"}], ";", 
        RowBox[{"MakePauli", "[", 
         RowBox[{"avec", ",", 
          RowBox[{"0", "*", "avec"}]}], "]"}]}], ")"}], "&"}], "/@", 
     RowBox[{"Range", "[", "mm", "]"}]}], "//", "mfl"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"the", " ", "binary", " ", "shift", " ", "vectors"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"BinaryShifts", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"IntegerDigits", "[", 
       RowBox[{"#", ",", "2", ",", "mm"}], "]"}], "&"}], "/@", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Nn", "/", 
        RowBox[{"2", "^", "kk"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"kk", ",", "1", ",", "mm"}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "The", " ", "action", " ", "of", " ", "these", " ", "shifts", " ", "on", 
     " ", "the", " ", "coordinates"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"shift", "=", "#"}], ";", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"FromDigits", "[", 
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"IntegerDigits", "[", 
                RowBox[{
                 RowBox[{"#", "-", "1"}], ",", "2", ",", "mm"}], "]"}], "+", 
               "shift"}], ",", "2"}], "]"}], ",", "2"}], "]"}], "+", "1"}], 
         "&"}], "/@", 
        RowBox[{"Range", "[", "Nn", "]"}]}]}], ")"}], "&"}], "/@", 
    "BinaryShifts"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "The", " ", "same", " ", "shifts", " ", "realized", " ", "by", " ", 
     "permutation", " ", "matrices"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"#", ".", 
      RowBox[{"Range", "[", "Nn", "]"}]}], "&"}], "/@", "PermMatEShifts"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "The", " ", "action", " ", "of", " ", "sum", " ", "shifts", " ", "on", 
     " ", "the", " ", "coordinates"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"shift", "=", 
        RowBox[{"Plus", "@@", 
         RowBox[{"(", 
          RowBox[{"BinaryShifts", "[", 
           RowBox[{"[", "#", "]"}], "]"}], ")"}]}]}], ";", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"FromDigits", "[", 
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"IntegerDigits", "[", 
                RowBox[{
                 RowBox[{"#", "-", "1"}], ",", "2", ",", "mm"}], "]"}], "+", 
               "shift"}], ",", "2"}], "]"}], ",", "2"}], "]"}], "+", "1"}], 
         "&"}], "/@", 
        RowBox[{"Range", "[", "Nn", "]"}]}]}], ")"}], "&"}], "/@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "2"}], "}"}]}], "}"}]}], "\n", 
   RowBox[{"(*", 
    RowBox[{
    "This", " ", "is", " ", "realized", " ", "by", " ", "sequential", " ", 
     "action", " ", "of", " ", "the", " ", "permutation", " ", "matrices"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"The", " ", "order", " ", "does", " ", "not", " ", "matter"}], 
     ",", 
     RowBox[{"as", " ", "these", " ", "permutators", " ", "commute"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"fir", "=", 
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", 
       RowBox[{"sec", "=", 
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", 
       RowBox[{
        RowBox[{"PermMatEShifts", "[", 
         RowBox[{"[", "fir", "]"}], "]"}], ".", 
        RowBox[{"PermMatEShifts", "[", 
         RowBox[{"[", "sec", "]"}], "]"}], ".", 
        RowBox[{"Range", "[", "Nn", "]"}]}]}], ")"}], "&"}], "/@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "2"}], "}"}]}], "}"}]}], "\n", "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DecodeRow", "=", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "vecin", ",", "mu", ",", "Sest", ",", "signbits", ",", "tt", ",", 
          "r", ",", "K", ",", "start", ",", "RangeNow", ",", "newK", ",", 
          "wht", ",", "abses", ",", "signs", ",", "metrics", ",", 
          "signbitsall", ",", "projectedvectors", ",", "Sests", ",", "peaks", 
          ",", "peak", ",", "Sestk", ",", "metrick", ",", "PhaseVec", ",", 
          "sigmak", ",", "signbitsk", ",", "Svec", ",", "avec", ",", "X", ",",
           "vecrot", ",", "veck", ",", "results", ",", "PermMatEsh", ",", 
          "peaki", ",", "withProjections"}], "}"}], ",", 
        RowBox[{
         RowBox[{"Sest", "=", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"vecin", "=", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"signbits", "=", 
          RowBox[{"#", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"mu", "=", 
          RowBox[{"#", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"tt", "=", 
          RowBox[{"#", "[", 
           RowBox[{"[", "5", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"r", "=", 
          RowBox[{"#", "[", 
           RowBox[{"[", "6", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"K", "=", 
          RowBox[{"#", "[", 
           RowBox[{"[", "7", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"withProjections", "=", 
          RowBox[{"#", "[", 
           RowBox[{"[", "8", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"start", "=", 
          RowBox[{
           RowBox[{"Transpose", "[", "Sest", "]"}], "[", 
           RowBox[{"[", "r", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"RangeNow", "=", 
          RowBox[{
           RowBox[{"Pick", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"2", "^", "mm"}], "]"}], ",", "tt"}], "]"}], "+", 
           RowBox[{"FromDigits", "[", 
            RowBox[{"start", ",", "2"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "In", " ", "the", " ", "end", " ", "K", " ", "might", " ", "be", 
           " ", "greater", " ", "than", " ", "the", " ", "number", " ", "of", 
           " ", "possible", " ", "different", " ", "rows"}], "*)"}], 
         RowBox[{"newK", "=", 
          RowBox[{"Min", "[", 
           RowBox[{"K", ",", 
            RowBox[{"Length", "[", "RangeNow", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Note", ":", 
            RowBox[{
            "For", " ", "precise", " ", "correspondence", " ", "as", " ", 
             "real", " ", "number"}]}], ",", 
           RowBox[{
           "one", " ", "has", " ", "to", " ", "multiply", " ", "with", " ", 
            RowBox[{"these", "!"}]}]}], "*)"}], 
         RowBox[{"avec", "=", "ZeroVecm"}], ";", 
         RowBox[{
          RowBox[{"avec", "[", 
           RowBox[{"[", "r", "]"}], "]"}], "=", "1"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
            RowBox[{"TODO", " ", "ad"}], "-", 
            RowBox[{"hoc", " ", "phasevec"}]}], ",", 
           RowBox[{
           "find", " ", "out", " ", "the", " ", "reason", " ", "why", " ", 
            "this", " ", "works"}]}], "*)"}], 
         RowBox[{"PhaseVec", "=", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"bvec", "=", 
                RowBox[{"IntegerDigits", "[", 
                 RowBox[{
                  RowBox[{"#", "-", "1"}], ",", "2", ",", "mm"}], "]"}]}], 
               ";", 
               RowBox[{"I", "^", 
                RowBox[{"(", 
                 RowBox[{"avec", ".", "bvec"}], ")"}]}]}], ")"}], "&"}], "/@", 
            RowBox[{"Range", "[", "Nn", "]"}]}], "//", "Chop"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"PermMatEsh", "=", 
          RowBox[{"PermMatEShifts", "[", 
           RowBox[{"[", "r", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"wht", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Sqrt", "[", "Nn", "]"}], "PhaseVec", "*", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Conjugate", "[", "vecin", "]"}], "*", 
               RowBox[{"(", 
                RowBox[{"PermMatEsh", ".", "vecin"}], ")"}]}], ")"}], ".", 
             "WHn"}]}], "//", "Chop"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"abses", "=", 
          RowBox[{"Abs", "[", "wht", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"signs", "=", 
          RowBox[{"Sign", "[", "wht", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"metrics", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"signbitsall", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"projectedvectors", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Sests", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"peaks", "=", 
            RowBox[{"Reverse", "[", 
             RowBox[{"Ordering", "[", "abses", "]"}], "]"}]}], ";"}], "*)"}], 
         RowBox[{"(*", 
          RowBox[{
          "improve", " ", "peaki", " ", "computation", " ", "maybe", " ", 
           "without", " ", "comparisons"}], "*)"}], 
         RowBox[{"peaks", "=", 
          RowBox[{"Reverse", "[", 
           RowBox[{"Sort", "[", 
            RowBox[{"abses", "[", 
             RowBox[{"[", "RangeNow", "]"}], "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"results", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"k", "=", "#"}], ";", "\[IndentingNewLine]", 
             RowBox[{"peaki", "=", 
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{"abses", ",", 
                 RowBox[{"peaks", "[", 
                  RowBox[{"[", "k", "]"}], "]"}]}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"peak", "=", 
                RowBox[{"peaks", "[", 
                 RowBox[{"[", "k", "]"}], "]"}]}], ";"}], "*)"}], 
             RowBox[{"(*", 
              RowBox[{
              "Mathematica", " ", "copies", " ", "arrays", " ", "by", " ", 
               "default", " ", "so", " ", "no", " ", "worries", " ", "of", 
               " ", "reference", " ", "problems"}], "*)"}], 
             RowBox[{"Sestk", "=", "Sest"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"withProjections", ",", 
               RowBox[{
                RowBox[{"metrick", "=", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"mu", "+", 
                    RowBox[{"abses", "[", 
                    RowBox[{"[", "peaki", "]"}], "]"}]}], ")"}], "/", "2"}]}],
                 ";"}], ",", 
               RowBox[{
                RowBox[{"metrick", "=", 
                 RowBox[{"(", 
                  RowBox[{"mu", "+", 
                   RowBox[{"abses", "[", 
                    RowBox[{"[", "peaki", "]"}], "]"}]}], ")"}]}], ";"}]}], 
              "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"May", " ", "give", " ", "wrong", " ", "result"}], 
              "*)"}], 
             RowBox[{"sigmak", "=", 
              RowBox[{"signs", "[", 
               RowBox[{"[", "peaki", "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"signbitsk", "=", "signbits"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"signbitsk", "[", 
               RowBox[{"[", "r", "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "+", "sigmak"}], ")"}], "/", "2"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Svec", "=", 
              RowBox[{"IntegerDigits", "[", 
               RowBox[{
                RowBox[{"peaki", "-", "1"}], ",", "2", ",", "mm"}], "]"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Sestk", "[", 
               RowBox[{"[", "r", "]"}], "]"}], "=", "Svec"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"withProjections", ",", 
               RowBox[{
                RowBox[{"avec", "=", "ZeroVecm"}], ";", 
                RowBox[{
                 RowBox[{"avec", "[", 
                  RowBox[{"[", "r", "]"}], "]"}], "=", "1"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{
                  "construct", " ", "the", " ", "Pauli", " ", "found"}], ",", 
                  RowBox[{
                   RowBox[{
                   "the", " ", "sought", " ", "for", " ", "codeword", " ", 
                    "is", " ", "an", " ", "eigenvector", " ", "of", " ", 
                    "this", " ", "Pauli", " ", "with", " ", "eigenvalue"}], 
                   "+", 
                   RowBox[{"-", "1"}]}]}], "*)"}], 
                RowBox[{"X", "=", 
                 RowBox[{"MakePauli", "[", 
                  RowBox[{"avec", ",", "Svec"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"vecrot", "=", 
                 RowBox[{"X", ".", "vecin"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"veck", "=", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"vecin", "+", 
                    RowBox[{"sigmak", "*", "vecrot"}]}], ")"}], "/", "2"}]}], 
                ";"}], ",", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{
                 "This", " ", "runs", " ", "if", " ", "withProjections"}], 
                 "=", "False"}], "*)"}], 
               RowBox[{
                RowBox[{"veck", "=", "vecin"}], ";"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"results", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"results", ",", 
                RowBox[{"{", 
                 RowBox[{
                 "Sestk", ",", "veck", ",", "signbitsk", ",", "metrick"}], 
                 "}"}]}], "]"}]}], ";"}], ")"}], "&"}], "/@", 
          RowBox[{"Range", "[", "newK", "]"}]}], ";", "\[IndentingNewLine]", 
         "results"}]}], "]"}], "&"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BreadthFirstDecoding", "=", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "vecin", ",", "ordering", ",", "tt", ",", "Sest", ",", "K", ",", 
          "candidatelist", ",", "newcandidates", ",", "r", ",", "inx", ",", 
          "jnx", ",", "metrics", ",", "peakinxs", ",", "withProjections", ",",
           "vecest", ",", "posi", ",", "best", ",", "inners", ",", "cvec", 
          ",", "candindices", ",", "shortrange"}], "}"}], ",", 
        RowBox[{
         RowBox[{"vecin", "=", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", 
         RowBox[{"ordering", "=", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ";", 
         RowBox[{"K", "=", 
          RowBox[{"#", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ";", 
         RowBox[{"withProjections", "=", 
          RowBox[{"#", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"tt", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"True", ",", 
            RowBox[{"2", "^", "mm"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Sest", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", "mm", "}"}], ",", 
            RowBox[{"{", "mm", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"candidatelist", "=", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{"0", ",", 
               RowBox[{"{", "mm", "}"}], ",", 
               RowBox[{"{", "mm", "}"}]}], "]"}], ",", "vecin", ",", 
             RowBox[{"Table", "[", 
              RowBox[{"0", ",", "mm"}], "]"}], ",", 
             RowBox[{
              RowBox[{"Norm", "[", "vecin", "]"}], "^", "2"}]}], "}"}], 
           "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"inx", "=", "#"}], ";", "\[IndentingNewLine]", 
             RowBox[{"newcandidates", "=", 
              RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"r", "=", 
              RowBox[{"ordering", "[", 
               RowBox[{"[", "inx", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"jnx", "=", "#"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{"FOR", " ", "FUTURE", " ", 
                    RowBox[{"DEVELOPEMENT", ":", 
                    RowBox[{
                    "If", " ", "ordering", " ", "is", " ", "modified", " ", 
                    "during", " ", "the", " ", "run"}]}]}], ",", 
                   RowBox[{
                   "this", " ", "needs", " ", "to", " ", "be", " ", 
                    "improved"}]}], "*)"}], 
                 RowBox[{"newcandidates", "=", 
                  RowBox[{"Join", "[", 
                   RowBox[{"newcandidates", ",", 
                    RowBox[{"DecodeRow", "[", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"candidatelist", "[", 
                    RowBox[{"[", "jnx", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "tt", ",", "r", ",", "K", ",", "withProjections"}], 
                    "}"}]}], "]"}], "]"}]}], "]"}]}], ";"}], ")"}], "&"}], "/@", 
              RowBox[{"Range", "[", 
               RowBox[{"Length", "[", "candidatelist", "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"metrics", "=", 
              RowBox[{"newcandidates", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"Range", "[", 
                  RowBox[{"Length", "[", "newcandidates", "]"}], "]"}], ",", 
                 "4"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"peakinxs", "=", 
              RowBox[{"Reverse", "[", 
               RowBox[{"Ordering", "[", "metrics", "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"shortrange", "=", 
              RowBox[{"Range", "[", 
               RowBox[{"Min", "[", 
                RowBox[{"K", ",", 
                 RowBox[{"Length", "[", "newcandidates", "]"}]}], "]"}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"candindices", "=", 
              RowBox[{"peakinxs", "[", 
               RowBox[{"[", "shortrange", "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"candidatelist", "=", 
              RowBox[{"newcandidates", "[", 
               RowBox[{"[", "candindices", "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"tt", "=", 
              RowBox[{"UpdateTruthTable", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"GiveTruthTable", "[", 
                  RowBox[{"{", 
                   RowBox[{"r", ",", "mm"}], "}"}], "]"}], ",", "tt"}], "}"}],
                "]"}]}], ";"}], ")"}], "&"}], "/@", 
          RowBox[{"Range", "[", "mm", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"withProjections", ",", 
           RowBox[{"posi", "=", "1"}], ",", 
           RowBox[{
            RowBox[{"inners", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"best", "=", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], ";", 
                 RowBox[{"best", "=", 
                  RowBox[{"1", "-", "best"}]}], ";", 
                 RowBox[{"Sest", "=", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"vecest", "=", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"cvec", "=", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"#", "-", "1"}], ",", "2", ",", "mm"}], "]"}]}], 
                    ";", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"-", "I"}], ")"}], "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"cvec", ".", "Sest", ".", "cvec"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"best", ".", "cvec"}]}]}], ")"}]}]}], ")"}], 
                    "&"}], "/@", 
                   RowBox[{"Range", "[", "Nn", "]"}]}]}], ";", 
                 RowBox[{"vecest", "=", 
                  RowBox[{"vecest", "/", 
                   RowBox[{"Norm", "[", "vecest", "]"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Abs", "[", 
                  RowBox[{
                   RowBox[{"Conjugate", "[", "tstvec", "]"}], ".", "vecest"}],
                   "]"}]}], ")"}], "&"}], "/@", "candidatelist"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"posi", "=", 
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"inners", ",", 
                RowBox[{"Max", "[", "inners", "]"}]}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"candidatelist", "[", 
          RowBox[{"[", "posi", "]"}], "]"}]}]}], "]"}], "&"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DecodingOrder", "=", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "vecin", ",", "maxis", ",", "PermMatEsh", ",", "abses", ",", 
          "permutetable"}], "}"}], ",", 
        RowBox[{
         RowBox[{"vecin", "=", "#"}], ";", "\[IndentingNewLine]", 
         RowBox[{"maxis", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"inx", "=", "#"}], ";", "\[IndentingNewLine]", 
             RowBox[{"PermMatEsh", "=", 
              RowBox[{"PermMatEShifts", "[", 
               RowBox[{"[", "inx", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"abses", "=", 
              RowBox[{"Abs", "[", 
               RowBox[{"Nn", "*", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Conjugate", "[", "vecin", "]"}], "*", 
                   RowBox[{"(", 
                    RowBox[{"PermMatEsh", ".", "vecin"}], ")"}]}], ")"}], ".",
                  "WHn"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"maxis", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"maxis", ",", 
                RowBox[{"Max", "[", "abses", "]"}]}], "]"}]}], ";"}], ")"}], 
           "&"}], "/@", 
          RowBox[{"Range", "[", "mm", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Reverse", "[", 
          RowBox[{"Ordering", "[", "maxis", "]"}], "]"}]}]}], "]"}], "&"}]}], 
    ";"}], "\n", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Swap", "=", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"tab", ",", "inx1", ",", "inx2", ",", "tmp"}], "}"}], ",", 
        RowBox[{
         RowBox[{"tab", "=", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", 
         RowBox[{"inx1", "=", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ";", 
         RowBox[{"inx2", "=", 
          RowBox[{"#", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"tmp", "=", 
          RowBox[{"tab", "[", 
           RowBox[{"[", "inx1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tab", "[", 
           RowBox[{"[", "inx1", "]"}], "]"}], "=", 
          RowBox[{"tab", "[", 
           RowBox[{"[", "inx2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tab", "[", 
           RowBox[{"[", "inx2", "]"}], "]"}], "=", "tmp"}], ";", 
         "\[IndentingNewLine]", "tab"}]}], "]"}], "&"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DecodingOrder2", "=", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"vecin", ",", "order"}], "}"}], ",", 
        RowBox[{
         RowBox[{"vecin", "=", "#"}], ";", "\[IndentingNewLine]", 
         RowBox[{"order", "=", 
          RowBox[{"DecodingOrder", "[", "vecin", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"order", "=", 
          RowBox[{"Swap", "[", 
           RowBox[{"{", 
            RowBox[{"order", ",", "1", ",", "2"}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "order"}]}], "]"}], "&"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DecodingOrder3", "=", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"vecin", ",", "order"}], "}"}], ",", 
        RowBox[{
         RowBox[{"vecin", "=", "#"}], ";", "\[IndentingNewLine]", 
         RowBox[{"order", "=", 
          RowBox[{"DecodingOrder", "[", "vecin", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"order", "=", 
          RowBox[{"Swap", "[", 
           RowBox[{"{", 
            RowBox[{"order", ",", "1", ",", "3"}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "order"}]}], "]"}], "&"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DecodingOrder4", "=", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"vecin", ",", "order"}], "}"}], ",", 
        RowBox[{
         RowBox[{"vecin", "=", "#"}], ";", "\[IndentingNewLine]", 
         RowBox[{"order", "=", 
          RowBox[{"DecodingOrder", "[", "vecin", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"order", "=", 
          RowBox[{"RotateRight", "[", 
           RowBox[{"order", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
         "order"}]}], "]"}], "&"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DecodingOrder5", "=", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"vecin", ",", "order"}], "}"}], ",", 
        RowBox[{
         RowBox[{"vecin", "=", "#"}], ";", "\[IndentingNewLine]", 
         RowBox[{"order", "=", 
          RowBox[{"DecodingOrder", "[", "vecin", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"order", "=", 
          RowBox[{"RotateRight", "[", 
           RowBox[{"order", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"order", "=", 
          RowBox[{"Swap", "[", 
           RowBox[{"{", 
            RowBox[{"order", ",", "1", ",", "2"}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "order"}]}], "]"}], "&"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GiveTruthTable", "=", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"index", ",", "size", ",", "basetable", ",", "binary"}], 
         "}"}], ",", 
        RowBox[{
         RowBox[{"input", "=", "#"}], ";", "\[IndentingNewLine]", 
         RowBox[{"index", "=", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"size", "=", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"binary", "=", 
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{"Floor", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Range", "[", 
                 RowBox[{"2", "^", "size"}], "]"}], "-", "1"}], ")"}], "/", 
              RowBox[{"2", "^", 
               RowBox[{"(", 
                RowBox[{"size", "-", "index"}], ")"}]}]}], "]"}], ",", "2"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"binary", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "==", "0"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"2", "^", "size"}]}], "}"}]}], "]"}]}]}], "]"}], "&"}]}],
     ";"}], "\n", 
   RowBox[{
    RowBox[{"UpdateTruthTable", "=", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"tt1", ",", "tt2"}], "}"}], ",", 
        RowBox[{
         RowBox[{"input", "=", "#"}], ";", "\[IndentingNewLine]", 
         RowBox[{"tt1", "=", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"tt2", "=", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"tt1", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "&&", 
            RowBox[{"tt2", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "tt1", "]"}]}], "}"}]}], "]"}]}]}], "]"}],
       "&"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\n"}]}]], "Input",
 CellChangeTimes->{{3.8642823381724434`*^9, 3.8642823459754934`*^9}, {
  3.8642824089973173`*^9, 3.86428241670939*^9}, {3.864282565973106*^9, 
  3.864282640197096*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"c9070705-3050-4190-9c55-31e606561bc6"],

Cell[CellGroupData[{

Cell[BoxData["\<\"These are real variables:\"\>"], "Print",
 CellChangeTimes->{3.8642826416955757`*^9, 3.864289497810932*^9, 
  3.864289871611868*^9, 3.8642904393281717`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"40fcbdc9-988e-4144-8d92-7b176239d592"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"a", ",", 
   SubscriptBox["a", "n_"], ",", "b", ",", 
   SubscriptBox["b", "n_"], ",", "x", ",", 
   SubscriptBox["x", "n_"], ",", "y", ",", 
   SubscriptBox["y", "n_"], ",", 
   OverscriptBox["x", "^"], ",", 
   SubscriptBox[
    OverscriptBox["x", "^"], "n_"], ",", 
   OverscriptBox["y", "^"], ",", 
   SubscriptBox[
    OverscriptBox["y", "^"], "n_"], ",", "r", ",", 
   SubscriptBox["r", "n_"], ",", "s", ",", 
   SubscriptBox["s", "n_"], ",", "q", ",", 
   SubscriptBox["q", "n_"], ",", "p", ",", 
   SubscriptBox["p", "n_"], ",", "\[Phi]", ",", 
   SubscriptBox["\[Phi]", "n_"], ",", "\[CurlyPhi]", ",", 
   SubscriptBox["\[CurlyPhi]", "n_"], ",", "\[Theta]", ",", 
   SubscriptBox["\[Theta]", "n_"], ",", "\[CurlyTheta]", ",", 
   SubscriptBox["\[CurlyTheta]", "n_"], ",", "\[Chi]", ",", 
   SubscriptBox["\[Chi]", "n_"], ",", "\[Psi]", ",", 
   SubscriptBox["\[Psi]", "n_"], ",", "\[Zeta]", ",", 
   SubscriptBox["\[Zeta]", "n_"], ",", "\[Rho]", ",", 
   SubscriptBox["\[Rho]", "n_"], ",", "\[CurlyRho]", ",", 
   SubscriptBox["\[CurlyRho]", "n_"], ",", "\[Eta]", ",", 
   SubscriptBox["\[Eta]", "n_"], ",", "m", ",", "n", ",", "k", ",", "l", ",", 
   "t", ",", "f", ",", "T"}], "}"}]], "Print",
 CellChangeTimes->{3.8642826416955757`*^9, 3.864289497810932*^9, 
  3.864289871611868*^9, 3.8642904393391705`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"a70bad95-714f-4d19-8b46-724e412852bb"],

Cell[BoxData["\<\"These are specifically complex variables:\"\>"], "Print",
 CellChangeTimes->{3.8642826416955757`*^9, 3.864289497810932*^9, 
  3.864289871611868*^9, 3.8642904393513055`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"56950326-84bc-4158-92db-bccb6f07dd79"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SubscriptBox["h", "n"], ",", 
   SuperscriptBox[
    RowBox[{"(", 
     SubscriptBox["h", "n"], ")"}], "*"], ",", 
   SuperscriptBox[
    RowBox[{"(", 
     SubscriptBox[
      OverscriptBox["h", "^"], "n"], ")"}], "*"], ",", 
   SubscriptBox[
    OverscriptBox["h", "^"], "n"], ",", 
   SubscriptBox["g", "n"], ",", 
   SuperscriptBox[
    RowBox[{"(", 
     SubscriptBox["g", "n"], ")"}], "*"], ",", 
   SuperscriptBox[
    RowBox[{"(", 
     SubscriptBox[
      OverscriptBox["g", "^"], "n"], ")"}], "*"], ",", 
   SubscriptBox[
    OverscriptBox["g", "^"], "n"], ",", 
   SubscriptBox["n", "p"], ",", 
   SuperscriptBox[
    RowBox[{"(", 
     SubscriptBox["n", "p"], ")"}], "*"], ",", 
   SuperscriptBox[
    RowBox[{"(", 
     SubscriptBox[
      OverscriptBox["n", "^"], "p"], ")"}], "*"], ",", 
   SubscriptBox[
    OverscriptBox["n", "^"], "p"], ",", 
   SubscriptBox["z", "n"], ",", 
   SuperscriptBox[
    RowBox[{"(", 
     SubscriptBox["z", "n"], ")"}], "*"], ",", "z", ",", 
   SuperscriptBox["z", "*"], ",", 
   SubscriptBox["w", "n"], ",", 
   SuperscriptBox[
    RowBox[{"(", 
     SubscriptBox["w", "n"], ")"}], "*"], ",", "w", ",", 
   SuperscriptBox["w", "*"], ",", 
   SubscriptBox["\[Mu]", "n"], ",", 
   SuperscriptBox[
    RowBox[{"(", 
     SubscriptBox["\[Mu]", "n"], ")"}], "*"], ",", 
   SubscriptBox["\[Nu]", "n"], ",", 
   SuperscriptBox[
    RowBox[{"(", 
     SubscriptBox["\[Nu]", "n"], ")"}], "*"], ",", "\[Alpha]", ",", 
   SuperscriptBox["\[Alpha]", "*"], ",", "\[Beta]", ",", 
   SuperscriptBox["\[Beta]", "*"], ",", "\[Nu]", ",", 
   SuperscriptBox["\[Nu]", "*"], ",", "\[Mu]", ",", 
   SuperscriptBox["\[Mu]", "*"], ",", "\[Kappa]", ",", 
   SuperscriptBox["\[Kappa]", "*"], ",", "\[Lambda]", ",", 
   SuperscriptBox["\[Lambda]", "*"]}], "}"}]], "Print",
 CellChangeTimes->{3.8642826416955757`*^9, 3.864289497810932*^9, 
  3.864289871611868*^9, 3.864290439357315*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"bb14aa1a-4357-4a1d-b020-aa64e09c13be"],

Cell[BoxData["\<\"Note that any variable which  is not specifically real, can \
be expressed with *. Conjugations do not work on these, but destar does. \
\"\>"], "Print",
 CellChangeTimes->{3.8642826416955757`*^9, 3.864289497810932*^9, 
  3.864289871611868*^9, 3.864290439366083*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"18b916eb-798f-4bcd-8dc6-aa688508fd4d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "7", ",", "7", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{
  3.864282580914542*^9, {3.8642826121499677`*^9, 3.864282641759906*^9}, 
   3.864289498223299*^9, 3.864289871681334*^9, 3.8642904396068172`*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"4543c614-5e4f-46db-b6f6-07fb0fc2f726"],

Cell[BoxData["16"], "Output",
 CellChangeTimes->{
  3.864282580914542*^9, {3.8642826121499677`*^9, 3.864282641759906*^9}, 
   3.864289498223299*^9, 3.864289871681334*^9, 3.8642904396207805`*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"7d92b7c4-3687-479f-a728-74772064e799"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "14", ",", "56", ",", "64"}], "}"}]], "Output",
 CellChangeTimes->{
  3.864282580914542*^9, {3.8642826121499677`*^9, 3.864282641759906*^9}, 
   3.864289498223299*^9, 3.864289871681334*^9, 3.864290439630886*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"f35a7137-f3b8-4eb9-b5c0-22d673fb37b0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"135", ",", "135"}], "}"}]], "Output",
 CellChangeTimes->{
  3.864282580914542*^9, {3.8642826121499677`*^9, 3.864282641759906*^9}, 
   3.864289498223299*^9, 3.864289871681334*^9, 3.864290439640853*^9},
 CellLabel->"Out[23]=",ExpressionUUID->"66d45fb2-53b0-43ea-a45c-19bf003c968a"],

Cell[BoxData["1080"], "Output",
 CellChangeTimes->{
  3.864282580914542*^9, {3.8642826121499677`*^9, 3.864282641759906*^9}, 
   3.864289498223299*^9, 3.864289871681334*^9, 3.8642904396508265`*^9},
 CellLabel->"Out[25]=",ExpressionUUID->"d6537d2e-7dc3-4884-8988-93c0e85f2250"],

Cell[BoxData["1.259601949631354`"], "Output",
 CellChangeTimes->{
  3.864282580914542*^9, {3.8642826121499677`*^9, 3.864282641759906*^9}, 
   3.864289498223299*^9, 3.864289871681334*^9, 3.8642904396610346`*^9},
 CellLabel->"Out[26]=",ExpressionUUID->"1cbd4a12-13d8-414f-bbb5-ba461782877a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.864282580914542*^9, {3.8642826121499677`*^9, 3.864282641759906*^9}, 
   3.864289498223299*^9, 3.864289871681334*^9, 3.864290439673084*^9},
 CellLabel->"Out[28]=",ExpressionUUID->"91b45402-bd24-49a2-98e0-86a997388207"],

Cell[BoxData["64"], "Output",
 CellChangeTimes->{
  3.864282580914542*^9, {3.8642826121499677`*^9, 3.864282641759906*^9}, 
   3.864289498223299*^9, 3.864289871681334*^9, 3.864290439686051*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"b00bcf9b-1c7a-4499-89cc-19555098c599"],

Cell[BoxData[
 RowBox[{"{", "0", "}"}]], "Output",
 CellChangeTimes->{
  3.864282580914542*^9, {3.8642826121499677`*^9, 3.864282641759906*^9}, 
   3.864289498223299*^9, 3.864289871681334*^9, 3.864290439696027*^9},
 CellLabel->"Out[34]=",ExpressionUUID->"976cf7c5-421c-4b23-9812-e719dd44905b"],

Cell[BoxData[
 RowBox[{"{", "0", "}"}]], "Output",
 CellChangeTimes->{
  3.864282580914542*^9, {3.8642826121499677`*^9, 3.864282641759906*^9}, 
   3.864289498223299*^9, 3.864289871681334*^9, 3.8642904398475943`*^9},
 CellLabel->"Out[35]=",ExpressionUUID->"07084747-37a4-4efc-b57d-d25fc71ba6f9"],

Cell[BoxData[
 RowBox[{"{", "0", "}"}]], "Output",
 CellChangeTimes->{
  3.864282580914542*^9, {3.8642826121499677`*^9, 3.864282641759906*^9}, 
   3.864289498223299*^9, 3.864289871681334*^9, 3.864290439856573*^9},
 CellLabel->"Out[36]=",ExpressionUUID->"57fdee5d-1f06-4362-bc56-5ae5b7e7aad5"],

Cell[BoxData[
 RowBox[{"{", "0", "}"}]], "Output",
 CellChangeTimes->{
  3.864282580914542*^9, {3.8642826121499677`*^9, 3.864282641759906*^9}, 
   3.864289498223299*^9, 3.864289871681334*^9, 3.864290439866074*^9},
 CellLabel->"Out[37]=",ExpressionUUID->"f3bd022e-8190-4173-9e2b-7b96d39909da"],

Cell[BoxData[
 RowBox[{"{", "0", "}"}]], "Output",
 CellChangeTimes->{
  3.864282580914542*^9, {3.8642826121499677`*^9, 3.864282641759906*^9}, 
   3.864289498223299*^9, 3.864289871681334*^9, 3.8642904398770533`*^9},
 CellLabel->"Out[39]=",ExpressionUUID->"fe2b0816-e03b-4c54-9a49-875aa027afe0"],

Cell[BoxData[
 RowBox[{"{", "0", "}"}]], "Output",
 CellChangeTimes->{
  3.864282580914542*^9, {3.8642826121499677`*^9, 3.864282641759906*^9}, 
   3.864289498223299*^9, 3.864289871681334*^9, 3.864290439934805*^9},
 CellLabel->"Out[41]=",ExpressionUUID->"69fe36c3-ad6c-48d4-b8e6-fad6561bfe92"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"64", ",", "512"}], "}"}]], "Output",
 CellChangeTimes->{
  3.864282580914542*^9, {3.8642826121499677`*^9, 3.864282641759906*^9}, 
   3.864289498223299*^9, 3.864289871681334*^9, 3.8642904400620136`*^9},
 CellLabel->"Out[45]=",ExpressionUUID->"ee4937f5-7adb-411f-b38c-241441eaecce"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0", "1", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "1", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "1", "0"},
       {"0", "0", "0", "0", "0", "0", "0", "1"},
       {"1", "0", "0", "0", "0", "0", "0", "0"},
       {"0", "1", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "1", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "1", "0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "1", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "1", "0", "0", "0", "0"},
       {"1", "0", "0", "0", "0", "0", "0", "0"},
       {"0", "1", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "1", "0"},
       {"0", "0", "0", "0", "0", "0", "0", "1"},
       {"0", "0", "0", "0", "1", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "1", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "1", "0", "0", "0", "0", "0", "0"},
       {"1", "0", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "1", "0", "0", "0", "0"},
       {"0", "0", "1", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "1", "0", "0"},
       {"0", "0", "0", "0", "1", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0", "1"},
       {"0", "0", "0", "0", "0", "0", "1", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.864282580914542*^9, {3.8642826121499677`*^9, 3.864282641759906*^9}, 
   3.864289498223299*^9, 3.864289871681334*^9, 3.8642904401028495`*^9},
 CellLabel->"Out[46]=",ExpressionUUID->"d9d2f6c8-a385-4e30-b2aa-14b52dcbe209"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0", "1", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "1", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "1", "0"},
       {"0", "0", "0", "0", "0", "0", "0", "1"},
       {"1", "0", "0", "0", "0", "0", "0", "0"},
       {"0", "1", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "1", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "1", "0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "1", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "1", "0", "0", "0", "0"},
       {"1", "0", "0", "0", "0", "0", "0", "0"},
       {"0", "1", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "1", "0"},
       {"0", "0", "0", "0", "0", "0", "0", "1"},
       {"0", "0", "0", "0", "1", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "1", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "1", "0", "0", "0", "0", "0", "0"},
       {"1", "0", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "1", "0", "0", "0", "0"},
       {"0", "0", "1", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "1", "0", "0"},
       {"0", "0", "0", "0", "1", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0", "1"},
       {"0", "0", "0", "0", "0", "0", "1", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.864282580914542*^9, {3.8642826121499677`*^9, 3.864282641759906*^9}, 
   3.864289498223299*^9, 3.864289871681334*^9, 3.864290440120801*^9},
 CellLabel->"Out[47]=",ExpressionUUID->"8b77a9b3-0d17-4c2e-968f-22eb6b5600e8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.864282580914542*^9, {3.8642826121499677`*^9, 3.864282641759906*^9}, 
   3.864289498223299*^9, 3.864289871681334*^9, 3.8642904401332645`*^9},
 CellLabel->"Out[48]=",ExpressionUUID->"2327429a-fa56-4384-bad5-53a9b1168eaa"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "5", ",", "6", ",", "7", ",", "8", ",", "1", ",", "2", ",", "3", ",", 
     "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "3", ",", "4", ",", "1", ",", "2", ",", "7", ",", "8", ",", "5", ",", 
     "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2", ",", "1", ",", "4", ",", "3", ",", "6", ",", "5", ",", "8", ",", 
     "7"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.864282580914542*^9, {3.8642826121499677`*^9, 3.864282641759906*^9}, 
   3.864289498223299*^9, 3.864289871681334*^9, 3.8642904401446686`*^9},
 CellLabel->"Out[49]=",ExpressionUUID->"09afbc78-7afe-4af8-97fb-108e03bf7a22"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "5", ",", "6", ",", "7", ",", "8", ",", "1", ",", "2", ",", "3", ",", 
     "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "3", ",", "4", ",", "1", ",", "2", ",", "7", ",", "8", ",", "5", ",", 
     "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2", ",", "1", ",", "4", ",", "3", ",", "6", ",", "5", ",", "8", ",", 
     "7"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.864282580914542*^9, {3.8642826121499677`*^9, 3.864282641759906*^9}, 
   3.864289498223299*^9, 3.864289871681334*^9, 3.8642904401526413`*^9},
 CellLabel->"Out[50]=",ExpressionUUID->"800cfc28-3975-46b2-b314-761fe8f602fb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "7", ",", "8", ",", "5", ",", "6", ",", "3", ",", "4", ",", "1", ",", 
     "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "4", ",", "3", ",", "2", ",", "1", ",", "8", ",", "7", ",", "6", ",", 
     "5"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.864282580914542*^9, {3.8642826121499677`*^9, 3.864282641759906*^9}, 
   3.864289498223299*^9, 3.864289871681334*^9, 3.86429044016162*^9},
 CellLabel->"Out[51]=",ExpressionUUID->"12535bba-ccc7-43e7-83b0-28165e901dcc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "7", ",", "8", ",", "5", ",", "6", ",", "3", ",", "4", ",", "1", ",", 
     "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "4", ",", "3", ",", "2", ",", "1", ",", "8", ",", "7", ",", "6", ",", 
     "5"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.864282580914542*^9, {3.8642826121499677`*^9, 3.864282641759906*^9}, 
   3.864289498223299*^9, 3.864289871681334*^9, 3.8642904401685996`*^9},
 CellLabel->"Out[52]=",ExpressionUUID->"1083df3c-cbe7-4f7c-95ed-658f7eb83fd2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"drops", " ", "=", " ", "100"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ktable", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
      "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "20", ",", "512"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Errortable", " ", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"K", " ", "=", " ", "#"}], ";", "\[IndentingNewLine]", 
        RowBox[{"errors", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"tstvec", " ", "=", " ", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "I"}], "}"}], ".", 
              RowBox[{"RandomVariate", "[", 
               RowBox[{
                RowBox[{"NormalDistribution", "[", 
                 RowBox[{"0", ",", "1"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "Nn"}], "}"}]}], "]"}]}]}], ";", " ", 
            RowBox[{"tstvec", " ", "=", " ", 
             RowBox[{"E", "^", 
              RowBox[{"(", 
               RowBox[{"I", "*", "2", "Pi", "*", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"10", ",", " ", "8"}], "]"}]}], ")"}]}]}], ";", " ", 
            RowBox[{"tstvec", " ", "=", " ", 
             RowBox[{"tstvec", "/", 
              RowBox[{"Norm", "[", "tstvec", "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"inners", " ", "=", " ", 
             RowBox[{"Abs", "[", 
              RowBox[{
               RowBox[{"Conjugate", "[", "tstvec", "]"}], ".", "CB"}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"posi", " ", "=", " ", 
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"inners", ",", 
                RowBox[{"Max", "[", "inners", "]"}]}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"ClosestVec", " ", "=", " ", 
             RowBox[{
              RowBox[{"Transpose", "[", "CB", "]"}], "[", 
              RowBox[{"[", "posi", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "Sest", ",", " ", "zleft", ",", " ", "best", ",", " ", 
               "metric"}], "}"}], " ", "=", " ", 
             RowBox[{"BreadthFirstDecoding", "[", 
              RowBox[{"{", 
               RowBox[{"tstvec", ",", " ", 
                RowBox[{"Range", "[", "mm", "]"}], ",", " ", "K", ",", 
                "True"}], "}"}], "]"}]}], ";", 
            RowBox[{"Sest", " ", "//", "mf"}], ";", "\[IndentingNewLine]", 
            RowBox[{"best", " ", "=", " ", 
             RowBox[{"1", "-", "best"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"vecest", " ", "=", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"cvec", " ", "=", " ", 
                  RowBox[{"IntegerDigits", "[", 
                   RowBox[{
                    RowBox[{"#", "-", "1"}], ",", "2", ",", "mm"}], "]"}]}], 
                 ";", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"-", "I"}], ")"}], "^", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"cvec", ".", "Sest", ".", "cvec"}], " ", "+", " ", 
                    RowBox[{"2", "*", 
                    RowBox[{"best", ".", "cvec"}]}]}], ")"}]}]}], ")"}], " ", 
               "&"}], "/@", " ", 
              RowBox[{"Range", "[", "Nn", "]"}]}]}], ";", " ", 
            RowBox[{"vecest", "  ", "=", " ", 
             RowBox[{"vecest", "/", 
              RowBox[{"Norm", "[", "vecest", "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Dist2", " ", "=", " ", 
             RowBox[{"1", "-", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"ClosestVec", ".", 
                 RowBox[{"Conjugate", "[", "vecest", "]"}]}], "]"}], "^", 
               "2"}]}]}], " ", ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"ClosestVec", ".", 
                 RowBox[{"Conj", "[", "vecest", "]"}]}], "]"}], "<=", " ", 
               "0.99"}], ",", 
              RowBox[{"errors", " ", "=", " ", 
               RowBox[{"errors", "+", "1"}]}]}], "]"}], ";"}], 
           "\[IndentingNewLine]", ")"}], "&"}], "/@", " ", 
         RowBox[{"Range", "[", "drops", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"Errortable", ",", " ", "errors"}], "]"}], ";"}], 
       "\[IndentingNewLine]", ")"}], "&"}], "/@", "Ktable"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"ListPlot", "[", 
    RowBox[{"Errortable", "/", "drops"}], "]"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.8642824201851363`*^9, 3.864282544273804*^9}, {
   3.8642894720754967`*^9, 3.8642894724505353`*^9}, {3.8642898585952253`*^9, 
   3.86428985906583*^9}, 3.864289897837989*^9, {3.8642899924026895`*^9, 
   3.8642900162439384`*^9}, {3.8642904561144247`*^9, 3.86429045659494*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"3abf7066-2cb9-4fc8-af1c-1e91327ca880"],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`], 
    AbsoluteThickness[1.6], 
    PointBox[{{1., 0.09}, {2., 0.02}, {3., 0.}, {4., 0.}, {5., 0.}, {6., 
     0.}, {7., 0.}}]}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0., 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0., 7}, {0, 0.05}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.8642826459011393`*^9, {3.8642894759839025`*^9, 3.864289502042622*^9}, {
   3.864289872946213*^9, 3.864289905529024*^9}, {3.8642900088310213`*^9, 
   3.864290032881796*^9}, {3.8642904497787943`*^9, 3.8642904739290657`*^9}},
 CellLabel->"Out[73]=",ExpressionUUID->"116a1155-9870-4241-9a1d-498decce2196"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Errortable", "/", "drops"}], " ", "//", " ", "N"}]], "Input",
 CellChangeTimes->{{3.8642900481182585`*^9, 3.864290062410453*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"66034010-e0c8-4f14-b5e6-7a5a957c5da2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.13`", ",", "0.05`", ",", "0.04`", ",", "0.02`", ",", "0.`", ",", "0.`", 
   ",", "0.`"}], "}"}]], "Output",
 CellChangeTimes->{{3.864290049448888*^9, 3.8642900628334684`*^9}, 
   3.864290449925785*^9},
 CellLabel->"Out[68]=",ExpressionUUID->"5f5c7150-5d6c-4293-afff-7405d0e16486"]
}, Open  ]]
},
WindowSize->{1428, 726},
WindowMargins->{{-0.75, Automatic}, {29.25, Automatic}},
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"23f68777-7f89-4a99-a03f-642d474676c5"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 54147, 1405, 4900, "Input",ExpressionUUID->"c9070705-3050-4190-9c55-31e606561bc6"],
Cell[CellGroupData[{
Cell[54752, 1431, 278, 5, 22, "Print",ExpressionUUID->"40fcbdc9-988e-4144-8d92-7b176239d592"],
Cell[55033, 1438, 1463, 32, 25, "Print",ExpressionUUID->"a70bad95-714f-4d19-8b46-724e412852bb"],
Cell[56499, 1472, 294, 5, 22, "Print",ExpressionUUID->"56950326-84bc-4158-92db-bccb6f07dd79"],
Cell[56796, 1479, 2053, 61, 30, "Print",ExpressionUUID->"bb14aa1a-4357-4a1d-b020-aa64e09c13be"],
Cell[58852, 1542, 388, 7, 22, "Print",ExpressionUUID->"18b916eb-798f-4bcd-8dc6-aa688508fd4d"]
}, Open  ]],
Cell[59255, 1552, 337, 6, 32, "Output",ExpressionUUID->"4543c614-5e4f-46db-b6f6-07fb0fc2f726"],
Cell[59595, 1560, 273, 4, 32, "Output",ExpressionUUID->"7d92b7c4-3687-479f-a728-74772064e799"],
Cell[59871, 1566, 338, 6, 32, "Output",ExpressionUUID->"f35a7137-f3b8-4eb9-b5c0-22d673fb37b0"],
Cell[60212, 1574, 319, 6, 32, "Output",ExpressionUUID->"66d45fb2-53b0-43ea-a45c-19bf003c968a"],
Cell[60534, 1582, 275, 4, 32, "Output",ExpressionUUID->"d6537d2e-7dc3-4884-8988-93c0e85f2250"],
Cell[60812, 1588, 289, 4, 32, "Output",ExpressionUUID->"1cbd4a12-13d8-414f-bbb5-ba461782877a"],
Cell[61104, 1594, 847, 22, 32, "Output",ExpressionUUID->"91b45402-bd24-49a2-98e0-86a997388207"],
Cell[61954, 1618, 271, 4, 32, "Output",ExpressionUUID->"b00bcf9b-1c7a-4499-89cc-19555098c599"],
Cell[62228, 1624, 292, 5, 32, "Output",ExpressionUUID->"976cf7c5-421c-4b23-9812-e719dd44905b"],
Cell[62523, 1631, 294, 5, 32, "Output",ExpressionUUID->"07084747-37a4-4efc-b57d-d25fc71ba6f9"],
Cell[62820, 1638, 292, 5, 32, "Output",ExpressionUUID->"57fdee5d-1f06-4362-bc56-5ae5b7e7aad5"],
Cell[63115, 1645, 292, 5, 32, "Output",ExpressionUUID->"f3bd022e-8190-4173-9e2b-7b96d39909da"],
Cell[63410, 1652, 294, 5, 32, "Output",ExpressionUUID->"fe2b0816-e03b-4c54-9a49-875aa027afe0"],
Cell[63707, 1659, 292, 5, 32, "Output",ExpressionUUID->"69fe36c3-ad6c-48d4-b8e6-fad6561bfe92"],
Cell[64002, 1666, 320, 6, 32, "Output",ExpressionUUID->"ee4937f5-7adb-411f-b38c-241441eaecce"],
Cell[64325, 1674, 2841, 69, 151, "Output",ExpressionUUID->"d9d2f6c8-a385-4e30-b2aa-14b52dcbe209"],
Cell[67169, 1745, 2839, 69, 151, "Output",ExpressionUUID->"8b77a9b3-0d17-4c2e-968f-22eb6b5600e8"],
Cell[70011, 1816, 504, 12, 32, "Output",ExpressionUUID->"2327429a-fa56-4384-bad5-53a9b1168eaa"],
Cell[70518, 1830, 687, 18, 32, "Output",ExpressionUUID->"09afbc78-7afe-4af8-97fb-108e03bf7a22"],
Cell[71208, 1850, 687, 18, 32, "Output",ExpressionUUID->"800cfc28-3975-46b2-b314-761fe8f602fb"],
Cell[71898, 1870, 554, 14, 32, "Output",ExpressionUUID->"12535bba-ccc7-43e7-83b0-28165e901dcc"],
Cell[72455, 1886, 557, 14, 32, "Output",ExpressionUUID->"1083df3c-cbe7-4f7c-95ed-658f7eb83fd2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73049, 1905, 5619, 128, 409, "Input",ExpressionUUID->"3abf7066-2cb9-4fc8-af1c-1e91327ca880"],
Cell[78671, 2035, 1517, 40, 262, "Output",ExpressionUUID->"116a1155-9870-4241-9a1d-498decce2196"]
}, Open  ]],
Cell[CellGroupData[{
Cell[80225, 2080, 243, 4, 28, "Input",ExpressionUUID->"66034010-e0c8-4f14-b5e6-7a5a957c5da2"],
Cell[80471, 2086, 325, 7, 32, "Output",ExpressionUUID->"5f5c7150-5d6c-4293-afff-7405d0e16486"]
}, Open  ]]
}
]
*)

