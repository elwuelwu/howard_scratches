(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    140681,       3287]
NotebookOptionsPosition[    133059,       3166]
NotebookOutlinePosition[    133493,       3183]
CellTagsIndexPosition[    133450,       3180]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Initialization of global variables and importing important structures\
\>", "Subsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{
  3.861942306306797*^9, {3.861942354794475*^9, 
   3.861942381090145*^9}},ExpressionUUID->"f461c790-49de-4413-931b-\
d40719c17a7f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"SET", " ", "HERE", " ", "THE", " ", "WORKING", " ", "DIRECTORY"}],
    " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
    "SetDirectory", "[", 
     "\"\</u/16/heikkie13/unix/howard_scratches/Mathematica\>\"", "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"<<", "libs/FunctionsComplexAnalysis.m"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"<<", "libs/FunctionsMatrixAnalysis.m"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"<<", "libs/FunctionsFiniteGroups.m"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"<<", "libs/FunctionsGF2.m"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"<<", "libs/FunctionsForExtraSpeciality.m"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "This", " ", "is", " ", "needed", " ", "for", " ", "the", " ", "unitary", 
     " ", "reps", " ", "of", " ", "symplectivc", " ", 
     RowBox[{"matrices", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"<<", "\"\<SymplecticBinary.m\>\""}], ";"}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Clear", "[", "AllBinMats", "]"}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dB", " ", "=", " ", 
     RowBox[{
      RowBox[{"10", "*", 
       RowBox[{"Log", "[", 
        RowBox[{"10", ",", 
         RowBox[{"N", "[", "#", "]"}]}], "]"}]}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"mm", ",", "rr"}], "]"}], ";"}]}]}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{
  3.8619421688263273`*^9, 3.861944013894755*^9, {3.861944857690401*^9, 
   3.861944861087811*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"1ba7e596-3ed0-40e6-8839-30538b4f23fd"],

Cell[BoxData["\<\"These are real variables:\"\>"], "Print",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{
  3.8619417889822893`*^9, 3.861942168826455*^9, 3.861943191834222*^9, 
   3.861943238970326*^9, 3.861943281036313*^9, 3.861943526437141*^9, 
   3.8619436981822357`*^9, 3.86194376186357*^9, 3.861943809955962*^9, 
   3.861943841004471*^9, 3.861944016624462*^9, 3.861944078768952*^9, 
   3.861944121146948*^9, {3.861944674981112*^9, 3.861944693660027*^9}, {
   3.8619448280372467`*^9, 3.86194486452697*^9}, {3.861945464932189*^9, 
   3.8619454861310062`*^9}, {3.861955202019424*^9, 3.861955229238863*^9}, 
   3.861955279916497*^9, 3.861955311297255*^9, 3.861955539922552*^9, 
   3.861955960294806*^9, 3.861956024458396*^9, 3.8619564952352667`*^9, 
   3.8619567967403297`*^9, 3.861962560288726*^9, 3.8619633767303267`*^9, 
   3.863248985436839*^9, 3.863837655625453*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"d42755b6-0d95-4359-ba0a-aad6a34f9142"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"a", ",", 
   SubscriptBox["a", "n_"], ",", "b", ",", 
   SubscriptBox["b", "n_"], ",", "x", ",", 
   SubscriptBox["x", "n_"], ",", "y", ",", 
   SubscriptBox["y", "n_"], ",", 
   OverscriptBox["x", "^"], ",", 
   SubscriptBox[
    OverscriptBox["x", "^"], "n_"], ",", 
   OverscriptBox["y", "^"], ",", 
   SubscriptBox[
    OverscriptBox["y", "^"], "n_"], ",", "r", ",", 
   SubscriptBox["r", "n_"], ",", "s", ",", 
   SubscriptBox["s", "n_"], ",", "q", ",", 
   SubscriptBox["q", "n_"], ",", "p", ",", 
   SubscriptBox["p", "n_"], ",", "\[Phi]", ",", 
   SubscriptBox["\[Phi]", "n_"], ",", "\[CurlyPhi]", ",", 
   SubscriptBox["\[CurlyPhi]", "n_"], ",", "\[Theta]", ",", 
   SubscriptBox["\[Theta]", "n_"], ",", "\[CurlyTheta]", ",", 
   SubscriptBox["\[CurlyTheta]", "n_"], ",", "\[Chi]", ",", 
   SubscriptBox["\[Chi]", "n_"], ",", "\[Psi]", ",", 
   SubscriptBox["\[Psi]", "n_"], ",", "\[Zeta]", ",", 
   SubscriptBox["\[Zeta]", "n_"], ",", "\[Rho]", ",", 
   SubscriptBox["\[Rho]", "n_"], ",", "\[CurlyRho]", ",", 
   SubscriptBox["\[CurlyRho]", "n_"], ",", "\[Eta]", ",", 
   SubscriptBox["\[Eta]", "n_"], ",", "m", ",", "n", ",", "k", ",", "l", ",", 
   "t", ",", "f", ",", "T"}], "}"}]], "Print",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{
  3.8619417889822893`*^9, 3.861942168826455*^9, 3.861943191834222*^9, 
   3.861943238970326*^9, 3.861943281036313*^9, 3.861943526437141*^9, 
   3.8619436981822357`*^9, 3.86194376186357*^9, 3.861943809955962*^9, 
   3.861943841004471*^9, 3.861944016624462*^9, 3.861944078768952*^9, 
   3.861944121146948*^9, {3.861944674981112*^9, 3.861944693660027*^9}, {
   3.8619448280372467`*^9, 3.86194486452697*^9}, {3.861945464932189*^9, 
   3.8619454861310062`*^9}, {3.861955202019424*^9, 3.861955229238863*^9}, 
   3.861955279916497*^9, 3.861955311297255*^9, 3.861955539922552*^9, 
   3.861955960294806*^9, 3.861956024458396*^9, 3.8619564952352667`*^9, 
   3.8619567967403297`*^9, 3.861962560288726*^9, 3.8619633767303267`*^9, 
   3.863248985436839*^9, 3.863837655628253*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"625ea918-9ed6-4038-9ac1-0f137d5ba706"],

Cell[BoxData["\<\"These are specifically complex variables:\"\>"], "Print",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{
  3.8619417889822893`*^9, 3.861942168826455*^9, 3.861943191834222*^9, 
   3.861943238970326*^9, 3.861943281036313*^9, 3.861943526437141*^9, 
   3.8619436981822357`*^9, 3.86194376186357*^9, 3.861943809955962*^9, 
   3.861943841004471*^9, 3.861944016624462*^9, 3.861944078768952*^9, 
   3.861944121146948*^9, {3.861944674981112*^9, 3.861944693660027*^9}, {
   3.8619448280372467`*^9, 3.86194486452697*^9}, {3.861945464932189*^9, 
   3.8619454861310062`*^9}, {3.861955202019424*^9, 3.861955229238863*^9}, 
   3.861955279916497*^9, 3.861955311297255*^9, 3.861955539922552*^9, 
   3.861955960294806*^9, 3.861956024458396*^9, 3.8619564952352667`*^9, 
   3.8619567967403297`*^9, 3.861962560288726*^9, 3.8619633767303267`*^9, 
   3.863248985436839*^9, 3.8638376556300507`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"83a0a57c-21b4-4650-9089-6ffb3232130f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SubscriptBox["h", "n"], ",", 
   SuperscriptBox[
    RowBox[{"(", 
     SubscriptBox["h", "n"], ")"}], "*"], ",", 
   SuperscriptBox[
    RowBox[{"(", 
     SubscriptBox[
      OverscriptBox["h", "^"], "n"], ")"}], "*"], ",", 
   SubscriptBox[
    OverscriptBox["h", "^"], "n"], ",", 
   SubscriptBox["g", "n"], ",", 
   SuperscriptBox[
    RowBox[{"(", 
     SubscriptBox["g", "n"], ")"}], "*"], ",", 
   SuperscriptBox[
    RowBox[{"(", 
     SubscriptBox[
      OverscriptBox["g", "^"], "n"], ")"}], "*"], ",", 
   SubscriptBox[
    OverscriptBox["g", "^"], "n"], ",", 
   SubscriptBox["n", "p"], ",", 
   SuperscriptBox[
    RowBox[{"(", 
     SubscriptBox["n", "p"], ")"}], "*"], ",", 
   SuperscriptBox[
    RowBox[{"(", 
     SubscriptBox[
      OverscriptBox["n", "^"], "p"], ")"}], "*"], ",", 
   SubscriptBox[
    OverscriptBox["n", "^"], "p"], ",", 
   SubscriptBox["z", "n"], ",", 
   SuperscriptBox[
    RowBox[{"(", 
     SubscriptBox["z", "n"], ")"}], "*"], ",", "z", ",", 
   SuperscriptBox["z", "*"], ",", 
   SubscriptBox["w", "n"], ",", 
   SuperscriptBox[
    RowBox[{"(", 
     SubscriptBox["w", "n"], ")"}], "*"], ",", "w", ",", 
   SuperscriptBox["w", "*"], ",", 
   SubscriptBox["\[Mu]", "n"], ",", 
   SuperscriptBox[
    RowBox[{"(", 
     SubscriptBox["\[Mu]", "n"], ")"}], "*"], ",", 
   SubscriptBox["\[Nu]", "n"], ",", 
   SuperscriptBox[
    RowBox[{"(", 
     SubscriptBox["\[Nu]", "n"], ")"}], "*"], ",", "\[Alpha]", ",", 
   SuperscriptBox["\[Alpha]", "*"], ",", "\[Beta]", ",", 
   SuperscriptBox["\[Beta]", "*"], ",", "\[Nu]", ",", 
   SuperscriptBox["\[Nu]", "*"], ",", "\[Mu]", ",", 
   SuperscriptBox["\[Mu]", "*"], ",", "\[Kappa]", ",", 
   SuperscriptBox["\[Kappa]", "*"], ",", "\[Lambda]", ",", 
   SuperscriptBox["\[Lambda]", "*"]}], "}"}]], "Print",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{
  3.8619417889822893`*^9, 3.861942168826455*^9, 3.861943191834222*^9, 
   3.861943238970326*^9, 3.861943281036313*^9, 3.861943526437141*^9, 
   3.8619436981822357`*^9, 3.86194376186357*^9, 3.861943809955962*^9, 
   3.861943841004471*^9, 3.861944016624462*^9, 3.861944078768952*^9, 
   3.861944121146948*^9, {3.861944674981112*^9, 3.861944693660027*^9}, {
   3.8619448280372467`*^9, 3.86194486452697*^9}, {3.861945464932189*^9, 
   3.8619454861310062`*^9}, {3.861955202019424*^9, 3.861955229238863*^9}, 
   3.861955279916497*^9, 3.861955311297255*^9, 3.861955539922552*^9, 
   3.861955960294806*^9, 3.861956024458396*^9, 3.8619564952352667`*^9, 
   3.8619567967403297`*^9, 3.861962560288726*^9, 3.8619633767303267`*^9, 
   3.863248985436839*^9, 3.8638376556314898`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"b85149de-da3b-41e3-b3d7-2b04a404dced"],

Cell[BoxData["\<\"Note that any variable which  is not specifically real, can \
be expressed with *. Conjugations do not work on these, but destar does. \
\"\>"], "Print",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{
  3.8619417889822893`*^9, 3.861942168826455*^9, 3.861943191834222*^9, 
   3.861943238970326*^9, 3.861943281036313*^9, 3.861943526437141*^9, 
   3.8619436981822357`*^9, 3.86194376186357*^9, 3.861943809955962*^9, 
   3.861943841004471*^9, 3.861944016624462*^9, 3.861944078768952*^9, 
   3.861944121146948*^9, {3.861944674981112*^9, 3.861944693660027*^9}, {
   3.8619448280372467`*^9, 3.86194486452697*^9}, {3.861945464932189*^9, 
   3.8619454861310062`*^9}, {3.861955202019424*^9, 3.861955229238863*^9}, 
   3.861955279916497*^9, 3.861955311297255*^9, 3.861955539922552*^9, 
   3.861955960294806*^9, 3.861956024458396*^9, 3.8619564952352667`*^9, 
   3.8619567967403297`*^9, 3.861962560288726*^9, 3.8619633767303267`*^9, 
   3.863248985436839*^9, 3.863837655633202*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"f3b7e79f-eddf-4997-947d-caf118a12e7e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "These", " ", "are", " ", "needed", " ", "for", " ", "functions", " ", 
    "to", " ", "work", " ", "properly"}], " ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "The", " ", "dimension", " ", "for", " ", "the", " ", "simulation", " ", 
     "must", " ", "be", " ", "chosen", " ", "here"}], ",", " ", 
    RowBox[{
    "as", " ", "multiple", " ", "data", " ", "structures", " ", "neede", " ", 
     "by", " ", "decoders", " ", "etc", " ", "depend", " ", "on", " ", 
     "m"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"mm", " ", "=", " ", "3"}], ";", " ", 
    RowBox[{"Nn", "=", " ", 
     RowBox[{"2", "^", "mm"}]}], ";", " ", 
    RowBox[{"InxBin", "=", " ", 
     RowBox[{"Tuples", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", "mm", "}"}]}], "]"}]}], ";", " ", 
    RowBox[{"WHn", " ", "=", " ", 
     RowBox[{
      RowBox[{"WHmatrix", "[", "Nn", "]"}], "/", 
      RowBox[{"Sqrt", "[", "Nn", "]"}]}]}], ";", "  ", 
    RowBox[{"InitializeVeryBare", "[", "mm", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ZeroVecm", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", "mm", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PermMatEShifts", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"TensorMany", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"unit2", ",", 
            RowBox[{"{", "#", "}"}]}], "]"}], ",", 
          RowBox[{"{", "sigx", "}"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"unit2", ",", 
            RowBox[{"{", 
             RowBox[{"mm", "-", "1", "-", "#"}], "}"}]}], "]"}]}], "]"}], 
        "]"}], " ", "&"}], "/@", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Range", "[", "mm", "]"}], "-", "1"}], ")"}]}]}], ";", " ", 
    RowBox[{"PermMatEShifts", " ", "//", "mfl"}]}]}]}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.861941747306032*^9, 3.861941757289713*^9}, {
   3.861941823228006*^9, 3.861941835329863*^9}, {3.861941889283022*^9, 
   3.861941902338385*^9}, 3.861942168827619*^9, {3.8619440044318237`*^9, 
   3.861944006270248*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"04ce83ea-1d79-4930-aa71-e07dd1556658"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0", "1", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "1", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "1", "0"},
       {"0", "0", "0", "0", "0", "0", "0", "1"},
       {"1", "0", "0", "0", "0", "0", "0", "0"},
       {"0", "1", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "1", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "1", "0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "1", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "1", "0", "0", "0", "0"},
       {"1", "0", "0", "0", "0", "0", "0", "0"},
       {"0", "1", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "1", "0"},
       {"0", "0", "0", "0", "0", "0", "0", "1"},
       {"0", "0", "0", "0", "1", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "1", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "1", "0", "0", "0", "0", "0", "0"},
       {"1", "0", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "1", "0", "0", "0", "0"},
       {"0", "0", "1", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "1", "0", "0"},
       {"0", "0", "0", "0", "1", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0", "1"},
       {"0", "0", "0", "0", "0", "0", "1", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "}"}]], "Output",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.861941890849238*^9, 3.861941902687026*^9}, 
   3.861942168828236*^9, 3.8619431920443974`*^9, 3.8619432391617928`*^9, 
   3.861943281226335*^9, 3.8619435266362953`*^9, 3.861943698371758*^9, 
   3.861943762071796*^9, 3.861943810135645*^9, 3.8619438413714867`*^9, 
   3.861944018788533*^9, 3.861944078956141*^9, 3.861944121485585*^9, {
   3.8619446759188557`*^9, 3.861944693915979*^9}, {3.861944841832766*^9, 
   3.861944864677724*^9}, {3.8619454650724077`*^9, 3.861945489592053*^9}, {
   3.8619552023931513`*^9, 3.861955229398929*^9}, 3.8619552800119343`*^9, 
   3.8619553114418793`*^9, 3.861955540110832*^9, 3.861955960413972*^9, 
   3.861956025182414*^9, 3.861956495416297*^9, 3.861956796911448*^9, 
   3.86196256397257*^9, 3.861963377692402*^9, 3.863248988096444*^9, 
   3.86383765782687*^9},
 CellLabel->"Out[11]=",ExpressionUUID->"d336739c-6f39-4eb3-bbc3-3f66ff9fb75d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Codebook", "Subsection",
 CellChangeTimes->{{3.861943646916992*^9, 
  3.861943676510009*^9}},ExpressionUUID->"b8ec32e4-7c90-4d56-a2d8-\
7943e4e7b8aa"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GenerateChirp", " ", "=", " ", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Sint", ",", " ", "bvec", ",", "xvec"}], "}"}], ",", 
       RowBox[{
        RowBox[{"Sint", " ", "=", " ", "#1"}], ";", " ", 
        RowBox[{"bvec", " ", "=", " ", "#2"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"xvec", "  ", "=", " ", 
             RowBox[{"IntegerDigits", "[", 
              RowBox[{
               RowBox[{"#", "-", "1"}], ",", "2", ",", "mm"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"I", "^", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"xvec", ".", "Sint", ".", "xvec"}], " ", "+", " ", 
                RowBox[{"2", " ", 
                 RowBox[{"bvec", ".", "xvec"}]}]}], ")"}]}], "/", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"2", "^", "mm"}], "]"}]}]}], ")"}], " ", "&"}], "/@", 
         " ", 
         RowBox[{"Range", "[", 
          RowBox[{"2", "^", "mm"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}],
      "&"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeUnitaryFromSymmetric", " ", "=", " ", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Sint", ",", "cvec", ",", "dvec", ",", "Ord2"}], "}"}], ",", 
       RowBox[{
        RowBox[{"Sint", " ", "=", " ", "#"}], ";", "\[IndentingNewLine]", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"cvec", " ", "=", " ", 
             RowBox[{"IntegerDigits", "[", 
              RowBox[{
               RowBox[{"#", "-", "1"}], ",", "2", ",", "mm"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Ord2", " ", "=", " ", 
             RowBox[{"cvec", ".", "Sint", ".", "cvec"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"dvec", "  ", "=", " ", 
                 RowBox[{"IntegerDigits", "[", 
                  RowBox[{
                   RowBox[{"#", "-", "1"}], ",", "2", ",", "mm"}], "]"}]}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"I", "^", 
                  RowBox[{"(", 
                   RowBox[{"Ord2", " ", "+", " ", 
                    RowBox[{"2", " ", 
                    RowBox[{"dvec", ".", "cvec"}]}]}], ")"}]}], "/", 
                 RowBox[{"Sqrt", "[", 
                  RowBox[{"2", "^", "mm"}], "]"}]}]}], "\[IndentingNewLine]", 
               ")"}], " ", "&"}], "/@", " ", 
             RowBox[{"Range", "[", 
              RowBox[{"2", "^", "mm"}], "]"}]}]}], "\[IndentingNewLine]", 
           ")"}], " ", "&"}], "/@", " ", 
         RowBox[{"Range", "[", 
          RowBox[{"2", "^", "mm"}], "]"}]}]}]}], " ", "]"}], "&"}]}], ";"}], 
  " ", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AllBinSymm", " ", "=", " ", 
   RowBox[{"GenerateSn2", "[", "mm", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AllUmats", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"MakeUnitaryFromSymmetric", "[", "#", "]"}], " ", "&"}], "/@", 
    " ", "AllBinSymm"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AllUmats", " ", "//", " ", "mfl"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CB", "  ", "=", " ", 
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Sequence", "@@", 
       RowBox[{"(", 
        RowBox[{"Transpose", "[", "#", "]"}], ")"}]}], " ", "&"}], "/@", " ", 
     "AllUmats"}], "]"}]}], ";", " ", 
  RowBox[{"card", " ", "=", " ", 
   RowBox[{"Length", "[", 
    RowBox[{"CB", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Length", "[", "AllUmats", "]"}], ",", "card"}], 
   "}"}]}]}], "Input",
 CellChangeTimes->{
  3.861943686223249*^9, {3.861943733255486*^9, 3.86194373524574*^9}, {
   3.861944230719985*^9, 3.861944423215626*^9}, {3.861945258121253*^9, 
   3.861945261449006*^9}},
 CellLabel->
  "In[288]:=",ExpressionUUID->"5581368c-9f69-46ad-a03d-a7117bab89cf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"64", ",", "512"}], "}"}]], "Output",
 CellChangeTimes->{
  3.86194369842128*^9, 3.861943762213338*^9, 3.861943810252946*^9, 
   3.861943841541067*^9, 3.8619440790610847`*^9, 3.8619441217107277`*^9, 
   3.861944427502055*^9, {3.861944676100128*^9, 3.861944694028784*^9}, {
   3.861944841929811*^9, 3.861944864776012*^9}, {3.861945465194964*^9, 
   3.861945490174749*^9}, {3.8619552025595217`*^9, 3.86195522949511*^9}, 
   3.8619552801156673`*^9, 3.861955311550851*^9, 3.861955540223617*^9, 
   3.8619559605316772`*^9, 3.861956025365142*^9, 3.8619564955602217`*^9, 
   3.8619567970088787`*^9, 3.8619625644788303`*^9, 3.861963377839666*^9, 
   3.8632516340933323`*^9, 3.863853588726489*^9},
 CellLabel->
  "Out[293]=",ExpressionUUID->"43f6847a-8f06-40f6-ba99-4d6896a68a2b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Decoders", "Subsection",
 CellChangeTimes->{{3.861942471914082*^9, 
  3.861942488115014*^9}},ExpressionUUID->"fe03d17b-d443-453a-9714-\
0221186a79c2"],

Cell[CellGroupData[{

Cell["Extended decoder", "Subsubsection",
 CellChangeTimes->{{3.8619503055449133`*^9, 
  3.861950317687359*^9}},ExpressionUUID->"03c61586-da18-4757-88a8-\
f75fa0f313d5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"GiveTruthTable", " ", "=", " ", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "index", ",", " ", "size", ",", " ", "basetable", ",", " ", "binary"}],
        "}"}], ",", " ", 
      RowBox[{
       RowBox[{"input", "=", "#"}], ";", "\[IndentingNewLine]", 
       RowBox[{"index", " ", "=", " ", 
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"size", " ", "=", " ", 
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"binary", " ", "=", " ", 
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"Floor", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Range", "[", 
               RowBox[{"2", "^", "size"}], "]"}], " ", "-", " ", "1"}], ")"}],
             " ", "/", " ", 
            RowBox[{"2", "^", 
             RowBox[{"(", 
              RowBox[{"size", " ", "-", "index"}], ")"}]}]}], "]"}], ",", " ",
           "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"binary", "[", 
           RowBox[{"[", "i", "]"}], "]"}], " ", "\[Equal]", " ", "0"}], ",", 
         " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "1", ",", " ", 
           RowBox[{"2", "^", "size"}]}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}], "&"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UpdateTruthTable", " ", "=", " ", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tt1", ",", " ", "tt2"}], "}"}], ",", " ", 
       RowBox[{
        RowBox[{"input", " ", "=", " ", "#"}], ";", "\[IndentingNewLine]", 
        RowBox[{"tt1", " ", "=", " ", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tt2", " ", "=", " ", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"tt1", "[", 
            RowBox[{"[", "i", "]"}], "]"}], " ", "&&", " ", 
           RowBox[{"tt2", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", 
            RowBox[{"Length", "[", "tt1", "]"}]}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], "&"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GiveTruthTableNew", " ", "=", " ", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "index", ",", " ", "size", ",", " ", "basetable", ",", " ", 
         "binary"}], "}"}], ",", " ", 
       RowBox[{
        RowBox[{"input", "=", "#"}], ";", "\[IndentingNewLine]", 
        RowBox[{"index", " ", "=", " ", "#1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"size", " ", "=", " ", "#2"}], ";", "\[IndentingNewLine]", 
        RowBox[{"binary", " ", "=", " ", 
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{"Floor", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Range", "[", 
                RowBox[{"2", "^", "size"}], "]"}], " ", "-", " ", "1"}], 
              ")"}], " ", "/", " ", 
             RowBox[{"2", "^", 
              RowBox[{"(", 
               RowBox[{"size", " ", "-", "index"}], ")"}]}]}], "]"}], ",", 
           " ", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"binary", "[", 
            RowBox[{"[", "i", "]"}], "]"}], " ", "\[Equal]", " ", "0"}], ",", 
          " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", 
            RowBox[{"2", "^", "size"}]}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], "&"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"UpdateTruthTableNew", " ", "=", " ", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Tt", ",", "Tt2", ",", " ", "R"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Tt", " ", "=", " ", "#1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"R", " ", "=", " ", "#2"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Tt2", " ", "=", " ", 
        RowBox[{"GiveTruthTableNew", "[", 
         RowBox[{"R", ",", " ", "mm"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Tt", "[", 
           RowBox[{"[", "i", "]"}], "]"}], " ", "&&", " ", 
          RowBox[{"Tt2", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "1", ",", " ", 
           RowBox[{"Length", "[", "Tt", "]"}]}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}], "&"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.863252741948863*^9, {3.8638511747134132`*^9, 3.8638513542328663`*^9}, {
   3.863851563001883*^9, 3.86385157980193*^9}, {3.863851705744813*^9, 
   3.863851708954143*^9}},
 CellLabel->
  "In[235]:=",ExpressionUUID->"98a14e7e-f82f-4e87-84fe-aac42208e2e8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExtendedDecoder", "=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "vecin", ",", "squared", ",", "Sest", ",", "best", ",", "MaskS", ",", 
        "MaskChirp", ",", "UnmaskedChirp", ",", "zleft", ",", "metric", ",", 
        "vecest"}], "}"}], ",", 
      RowBox[{
       RowBox[{"vecin", "=", "#"}], ";", "\[IndentingNewLine]", 
       RowBox[{"squared", "=", 
        RowBox[{"vecin", "*", "vecin"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"squared", "=", 
        RowBox[{"squared", "/", 
         RowBox[{"Norm", "[", "squared", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "Sest", ",", " ", "zleft", ",", " ", "best", ",", " ", "metric"}], 
         "}"}], "=", 
        RowBox[{"BreadthFirstDecoding", "[", 
         RowBox[{"{", 
          RowBox[{"squared", ",", " ", 
           RowBox[{"Range", "[", "mm", "]"}], ",", " ", "1", ",", " ", 
           "False"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"MaskS", "=", 
        RowBox[{"Sest", "/", "2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"MaskChirp", "=", " ", 
        RowBox[{"GenerateChirp", "[", 
         RowBox[{"MaskS", ",", "ZeroVecm"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"UnmaskedChirp", "=", 
        RowBox[{"vecin", "*", 
         RowBox[{"Conjugate", "[", "MaskChirp", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"UnmaskedChirp", "=", 
        RowBox[{"UnmaskedChirp", "/", 
         RowBox[{"Norm", "[", "UnmaskedChirp", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "Sest", ",", " ", "zleft", ",", " ", "best", ",", " ", "metric"}], 
         "}"}], "=", 
        RowBox[{"BreadthFirstDecoding", "[", 
         RowBox[{"{", 
          RowBox[{"UnmaskedChirp", ",", " ", 
           RowBox[{"Range", "[", "mm", "]"}], ",", " ", "1", ",", " ", 
           "False"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Sest", "+", "MaskS"}], ",", "best"}], "}"}]}]}], "]"}], 
    "&"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.861950342218755*^9, 3.861950421160336*^9}, 
   3.861955306937323*^9, {3.861955517442924*^9, 3.861955522826652*^9}, {
   3.861955607638343*^9, 3.861955614193616*^9}, {3.861955656431727*^9, 
   3.8619557449380827`*^9}, {3.861959692303811*^9, 3.861959696321076*^9}, {
   3.861961561365851*^9, 3.8619615665356894`*^9}, {3.861962775895337*^9, 
   3.861962813497752*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"6fe6b4a7-d33b-44ca-a436-1b27cc316451"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Truth table calculators and decoding order", "Subsubsection",
 CellChangeTimes->{{3.861943005614047*^9, 
  3.861943021995367*^9}},ExpressionUUID->"e4a3f8f8-d77d-4ebd-90bb-\
ece0f018ed45"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DecodingOrder", " ", "=", " ", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "vecin", ",", " ", "maxis", ",", " ", "PermMatEsh", ",", " ", "abses",
          ",", " ", "permutetable"}], "}"}], ",", " ", 
       RowBox[{
        RowBox[{"vecin", " ", "=", " ", "#"}], ";", "\[IndentingNewLine]", 
        RowBox[{"maxis", " ", "=", " ", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"inx", " ", "=", " ", "#"}], ";", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{"PermMatEsh", " ", "=", "  ", 
             RowBox[{"PermMatEShifts", "[", 
              RowBox[{"[", "inx", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{"abses", " ", "=", " ", 
             RowBox[{"Abs", "[", " ", 
              RowBox[{"Nn", "*", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Conjugate", "[", "vecin", "]"}], "*", 
                  RowBox[{"(", 
                   RowBox[{"PermMatEsh", ".", "vecin"}], ")"}]}], ")"}], ".", 
                "WHn"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
            RowBox[{"maxis", "  ", "=", " ", 
             RowBox[{"Append", "[", 
              RowBox[{"maxis", ",", " ", 
               RowBox[{"Max", "[", "abses", "]"}]}], "]"}]}], ";"}], 
           "\[IndentingNewLine]", ")"}], " ", "&"}], "/@", " ", 
         RowBox[{"Range", "[", "mm", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Reverse", "[", 
         RowBox[{"Ordering", "[", "maxis", "]"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], "&"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GiveTruthTable", " ", "=", " ", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "index", ",", " ", "size", ",", " ", "basetable", ",", " ", 
         "binary"}], "}"}], ",", " ", 
       RowBox[{
        RowBox[{"input", "=", "#"}], ";", "\[IndentingNewLine]", 
        RowBox[{"index", " ", "=", " ", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"size", " ", "=", " ", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"binary", " ", "=", " ", 
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{"Floor", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Range", "[", 
                RowBox[{"2", "^", "size"}], "]"}], " ", "-", " ", "1"}], 
              ")"}], " ", "/", " ", 
             RowBox[{"2", "^", 
              RowBox[{"(", 
               RowBox[{"size", " ", "-", "index"}], ")"}]}]}], "]"}], ",", 
           " ", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"binary", "[", 
            RowBox[{"[", "i", "]"}], "]"}], " ", "\[Equal]", " ", "0"}], ",", 
          " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", 
            RowBox[{"2", "^", "size"}]}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], "&"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"UpdateTruthTable", " ", "=", " ", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tt1", ",", " ", "tt2"}], "}"}], ",", " ", 
      RowBox[{
       RowBox[{"input", " ", "=", " ", "#"}], ";", "\[IndentingNewLine]", 
       RowBox[{"tt1", " ", "=", " ", 
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tt2", " ", "=", " ", 
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"tt1", "[", 
           RowBox[{"[", "i", "]"}], "]"}], " ", "&&", " ", 
          RowBox[{"tt2", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "1", ",", " ", 
           RowBox[{"Length", "[", "tt1", "]"}]}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}], "&"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.861943031189868*^9, 3.861943054037953*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"0eaa0858-b649-4b1a-b2d4-d64a48e04686"]
}, Closed]],

Cell[CellGroupData[{

Cell["Row decoders", "Subsubsection",
 CellChangeTimes->{{3.861942838606208*^9, 
  3.861942842835093*^9}},ExpressionUUID->"b186a04f-c53b-4a22-bdbc-\
1a717bc84296"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DecodeRowListNew", " ", "=", " ", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "start", ",", " ", "PauliMat", ",", " ", "Metrics", ",", " ", 
         "Results", ",", " ", "Projectedvectors", ",", " ", "Peaks", ",", " ",
          "Peaki", ",", " ", "Peakinxs", ",", " ", "Sestk", ",", " ", 
         "Metrick", ",", " ", "Signbitsall", ",", " ", "projectedvectors", 
         ",", " ", "Sests", ",", " ", "Sest", ",", " ", "R", ",", " ", "K", 
         ",", " ", "RangeNow", ",", " ", "Tt", ",", " ", "vecrot", ",", " ", 
         "NewK", ",", "  ", "Signbits", ",", " ", "Svec", ",", " ", 
         "Signbitsk", ",", " ", "Sigmak", ",", " ", "veck", ",", " ", "Mu", 
         ",", " ", "WithProjections", ",", " ", "avec", ",", " ", "bvec", ",",
          " ", "PhaseVec", ",", " ", "PermMatEsh", ",", " ", "Wht", ",", " ", 
         "vecin", ",", " ", "Abses", ",", " ", "Signs"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Sest", " ", "=", " ", "#1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Signbits", " ", "=", " ", "#2"}], ";", "\[IndentingNewLine]", 
        RowBox[{"vecin", " ", "=", " ", "#3"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Mu", " ", "=", " ", "#4"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Tt", " ", "=", " ", "#5"}], ";", "\[IndentingNewLine]", 
        RowBox[{"WithProjections", " ", "=", " ", "#6"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"K", " ", "=", " ", "#7"}], ";", "\[IndentingNewLine]", 
        RowBox[{"R", " ", "=", " ", "#8"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<The difference in norms: \>\"", ",", " ", 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"vecin", ".", 
             RowBox[{"Conjugate", "[", "vecin", "]"}]}], " ", "-", " ", 
            "Mu"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"start", " ", "=", " ", 
         RowBox[{
          RowBox[{"Transpose", "[", "Sest", "]"}], "[", 
          RowBox[{"[", "R", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"RangeNow", "=", 
         RowBox[{
          RowBox[{"Pick", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"2", "^", "mm"}], "]"}], ",", "Tt"}], "]"}], " ", "+", 
          " ", 
          RowBox[{"FromDigits", "[", 
           RowBox[{"start", ",", "2"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "In", " ", "the", " ", "end", " ", "K", " ", "might", " ", "be", " ",
           "greater", " ", "than", " ", "the", " ", "number", " ", "of", " ", 
          "possible", " ", "different", " ", "rows"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"NewK", " ", "=", " ", 
         RowBox[{"Min", "[", 
          RowBox[{"K", ",", " ", 
           RowBox[{"Length", "[", "RangeNow", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "This", " ", "normalizes", " ", "out", " ", "the", " ", "phase", " ", 
          RowBox[{"i", "^", 
           RowBox[{"{", 
            RowBox[{"e_i", ".", "S", ".", 
             RowBox[{"e_i", "^", "T"}]}], "}"}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"avec", " ", "=", " ", "ZeroVecm"}], ";", " ", 
        RowBox[{
         RowBox[{"avec", "[", 
          RowBox[{"[", "R", "]"}], "]"}], "=", "1"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"PhaseVec", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"bvec", " ", "=", " ", 
              RowBox[{"IntegerDigits", "[", 
               RowBox[{
                RowBox[{"#", "-", "1"}], ",", "2", ",", "mm"}], "]"}]}], ";", 
             " ", 
             RowBox[{"I", "^", 
              RowBox[{"(", 
               RowBox[{"-", 
                RowBox[{"avec", ".", "bvec"}]}], ")"}]}]}], ")"}], " ", "&"}],
           "/@", " ", 
          RowBox[{"Range", "[", "Nn", "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"PermMatEsh", " ", "=", "  ", 
         RowBox[{"PermMatEShifts", "[", 
          RowBox[{"[", "R", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Wht", " ", "=", "  ", 
         RowBox[{
          RowBox[{"Sqrt", "[", "Nn", "]"}], "PhaseVec", "*", 
          RowBox[{"DiscreteHadamardTransform", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Conjugate", "[", "vecin", "]"}], "*", 
             RowBox[{"(", 
              RowBox[{"PermMatEsh", ".", "vecin"}], ")"}]}], ",", " ", 
            RowBox[{"Method", "->", "\"\<BitComplement\>\""}]}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Abses", " ", "=", " ", 
         RowBox[{
          RowBox[{"Conjugate", "[", "Wht", "]"}], "*", "Wht"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Signs", " ", "=", " ", 
         RowBox[{"Sign", "[", 
          RowBox[{"Re", "[", "Wht", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Metrics", " ", "=", " ", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Signbitsall", " ", "=", " ", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Projectedvectors", " ", "=", " ", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Sests", " ", "=", " ", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Peakinxs", " ", "=", " ", 
         RowBox[{"Take", "[", 
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"Reverse", "[", 
              RowBox[{"Ordering", "[", "Abses", "]"}], "]"}], ",", " ", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{"RangeNow", ",", " ", "#"}], "]"}], "&"}]}], "]"}], 
           ",", " ", "NewK"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Results", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"(", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Peaki", " ", "=", " ", "#"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
              "Mathematica", " ", "copies", " ", "arrays", " ", "by", " ", 
               "default", " ", "so", " ", "no", " ", "worries", " ", "of", 
               " ", "reference", " ", "problems"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"Sestk", " ", "=", " ", "Sest"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"WithProjections", ",", " ", 
               RowBox[{
                RowBox[{"Metrick", " ", "=", " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Mu", " ", "+", " ", 
                    RowBox[{"Abses", "[", 
                    RowBox[{"[", "Peaki", "]"}], "]"}]}], ")"}], " ", "/", 
                  " ", "2"}]}], ";"}], ",", " ", 
               RowBox[{
                RowBox[{"Metrick", " ", "=", " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Mu", " ", "+", " ", 
                    RowBox[{"Abses", "[", 
                    RowBox[{"[", "Peaki", "]"}], "]"}]}], ")"}], "/", "2"}]}],
                 ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"Sigmak", " ", "=", " ", 
              RowBox[{"Signs", "[", 
               RowBox[{"[", "Peaki", "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{"\"\<Sigmak: \>\"", ",", " ", "Sigmak"}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Signbitsk", " ", "=", " ", "Signbits"}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Signbitsk", "[", 
               RowBox[{"[", "R", "]"}], "]"}], " ", "=", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", " ", "-", " ", "Sigmak"}], ")"}], " ", "/", " ", 
               "2"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{"\"\<B-bit: \>\"", ",", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "Sigmak"}], ")"}], "/", "2"}]}], "]"}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"Svec", "  ", "=", " ", 
              RowBox[{"IntegerDigits", "[", 
               RowBox[{
                RowBox[{"Peaki", "-", "1"}], ",", "2", ",", "mm"}], "]"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Sestk", "[", 
               RowBox[{"[", "R", "]"}], "]"}], "=", "Svec"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"WithProjections", ",", " ", 
               RowBox[{
                RowBox[{"avec", " ", "=", " ", "ZeroVecm"}], ";", " ", 
                RowBox[{
                 RowBox[{"avec", "[", 
                  RowBox[{"[", "R", "]"}], "]"}], "=", "1"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"PauliMat", " ", "=", " ", 
                 RowBox[{"MakePauli", "[", 
                  RowBox[{"avec", ",", "Svec"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"vecrot", " ", "=", " ", 
                 RowBox[{"vecin", ".", "PauliMat"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"veck", " ", "=", " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"vecin", " ", "+", " ", 
                    RowBox[{"Sigmak", " ", "*", " ", "vecrot"}]}], ")"}], " ",
                   "/", " ", "2"}]}], ";"}], "\[IndentingNewLine]", ",", " ", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{
                 RowBox[{
                 "This", " ", "runs", " ", "if", " ", "withProjections"}], 
                 " ", "=", " ", "False"}], " ", "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"veck", " ", "=", " ", "vecin"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
              "Sestk", ",", " ", "Signbitsk", ",", "veck", ",", " ", 
               "Metrick"}], "}"}]}], "\[IndentingNewLine]", ")"}], "&"}], "/@",
           " ", "Peakinxs"}]}], ";", "\[IndentingNewLine]", "Results"}]}], 
      "\[IndentingNewLine]", "]"}], "&"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DecodeRowList", " ", "=", " ", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "vecin", ",", " ", "mu", ",", " ", "Sest", ",", " ", "signbits", ",", 
        " ", "tt", ",", " ", "r", ",", " ", "K", ",", " ", "start", ",", " ", 
        "RangeNow", ",", " ", "newK", ",", " ", "wht", ",", " ", "abses", ",",
         " ", "signs", ",", " ", "metrics", ",", " ", "signbitsall", ",", " ",
         "projectedvectors", ",", " ", "Sests", ",", " ", "peaks", ",", " ", 
        "peak", ",", " ", "Sestk", ",", " ", "metrick", " ", ",", " ", "k", 
        ",", " ", "PhaseVec", ",", " ", "sigmak", ",", " ", "signbitsk", ",", 
        " ", "Svec", ",", " ", "avec", ",", " ", "bvec", ",", " ", "X", ",", 
        " ", "vecrot", ",", " ", "veck", ",", " ", "results", ",", " ", 
        "PermMatEsh", ",", " ", "peaki", ",", " ", "withProjections"}], "}"}],
       ",", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Sest", " ", "=", " ", "#1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"vecin", " ", "=", " ", "#2"}], ";", "\[IndentingNewLine]", 
       RowBox[{"signbits", " ", "=", " ", "#3"}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"mu", " ", "=", " ", 
        RowBox[{"#", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tt", " ", "=", " ", 
        RowBox[{"#", "[", 
         RowBox[{"[", "5", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"r", " ", "=", " ", 
        RowBox[{"#", "[", 
         RowBox[{"[", "6", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"K", " ", "=", " ", 
        RowBox[{"#", "[", 
         RowBox[{"[", "7", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"withProjections", " ", "=", " ", 
        RowBox[{"#", "[", 
         RowBox[{"[", "8", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"start", " ", "=", " ", 
        RowBox[{
         RowBox[{"Transpose", "[", "Sest", "]"}], "[", 
         RowBox[{"[", "r", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"RangeNow", "=", 
        RowBox[{
         RowBox[{"Pick", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"2", "^", "mm"}], "]"}], ",", "tt"}], "]"}], " ", "+", 
         " ", 
         RowBox[{"FromDigits", "[", 
          RowBox[{"start", ",", "2"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "In", " ", "the", " ", "end", " ", "K", " ", "might", " ", "be", " ", 
         "greater", " ", "than", " ", "the", " ", "number", " ", "of", " ", 
         "possible", " ", "different", " ", "rows"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"newK", " ", "=", " ", 
        RowBox[{"Min", "[", 
         RowBox[{"K", ",", " ", 
          RowBox[{"Length", "[", "RangeNow", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"avec", " ", "=", " ", "ZeroVecm"}], ";", " ", 
       RowBox[{
        RowBox[{"avec", "[", 
         RowBox[{"[", "r", "]"}], "]"}], "=", "1"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"PhaseVec", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"bvec", " ", "=", " ", 
             RowBox[{"IntegerDigits", "[", 
              RowBox[{
               RowBox[{"#", "-", "1"}], ",", "2", ",", "mm"}], "]"}]}], ";", 
            " ", 
            RowBox[{"I", "^", 
             RowBox[{"(", 
              RowBox[{"-", 
               RowBox[{"avec", ".", "bvec"}]}], ")"}]}]}], ")"}], " ", "&"}], 
         "/@", " ", 
         RowBox[{"Range", "[", "Nn", "]"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"PermMatEsh", " ", "=", "  ", 
        RowBox[{"PermMatEShifts", "[", 
         RowBox[{"[", "r", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"wht", " ", "=", "  ", 
        RowBox[{
         RowBox[{"Sqrt", "[", "Nn", "]"}], "PhaseVec", "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Conjugate", "[", "vecin", "]"}], "*", 
            RowBox[{"(", 
             RowBox[{"PermMatEsh", ".", "vecin"}], ")"}]}], ")"}], ".", 
          "WHn"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"abses", " ", "=", " ", 
        RowBox[{"Abs", "[", "wht", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"signs", " ", "=", " ", 
        RowBox[{"Sign", "[", 
         RowBox[{"Re", "[", "wht", "]"}], "]"}]}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"metrics", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"signbitsall", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"projectedvectors", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Sests", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"peaks", " ", "=", " ", 
        RowBox[{"Reverse", "[", 
         RowBox[{"Sort", "[", 
          RowBox[{"abses", "[", 
           RowBox[{"[", "RangeNow", "]"}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"results", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"k", "=", "#"}], ";", "\[IndentingNewLine]", 
           RowBox[{"peaki", " ", "=", " ", 
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"abses", ",", 
               RowBox[{"peaks", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"peak", " ", "=", " ", 
              RowBox[{"peaks", "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], ";"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Mathematica", " ", "copies", " ", "arrays", " ", "by", " ", 
             "default", " ", "so", " ", "no", " ", "worries", " ", "of", " ", 
             "reference", " ", "problems"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"Sestk", " ", "=", " ", "Sest"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"withProjections", ",", " ", 
             RowBox[{
              RowBox[{"metrick", " ", "=", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"mu", " ", "+", " ", 
                  RowBox[{"abses", "[", 
                   RowBox[{"[", "peaki", "]"}], "]"}]}], ")"}], " ", "/", " ",
                 "2"}]}], ";"}], ",", " ", 
             RowBox[{
              RowBox[{"metrick", " ", "=", " ", 
               RowBox[{"(", 
                RowBox[{"mu", " ", "+", " ", 
                 RowBox[{"abses", "[", 
                  RowBox[{"[", "peaki", "]"}], "]"}]}], ")"}]}], ";"}]}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"May", " ", "give", " ", "wrong", " ", "result"}], " ", 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{"sigmak", " ", "=", " ", 
            RowBox[{"signs", "[", 
             RowBox[{"[", "peaki", "]"}], "]"}]}], ";", "\[IndentingNewLine]",
            "\[IndentingNewLine]", 
           RowBox[{"signbitsk", " ", "=", " ", "signbits"}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"signbitsk", "[", 
             RowBox[{"[", "r", "]"}], "]"}], " ", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", " ", "-", " ", "sigmak"}], ")"}], " ", "/", " ", 
             "2"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"Svec", "  ", "=", " ", 
            RowBox[{"IntegerDigits", "[", 
             RowBox[{
              RowBox[{"peaki", "-", "1"}], ",", "2", ",", "mm"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Sestk", "[", 
             RowBox[{"[", "r", "]"}], "]"}], "=", "Svec"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"withProjections", ",", " ", 
             RowBox[{
              RowBox[{"avec", " ", "=", " ", "ZeroVecm"}], ";", " ", 
              RowBox[{
               RowBox[{"avec", "[", 
                RowBox[{"[", "r", "]"}], "]"}], "=", "1"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{
                "construct", " ", "the", "  ", "Pauli", " ", "found"}], ",", 
                " ", 
                RowBox[{
                 RowBox[{
                 "the", " ", "sought", " ", "for", " ", "codeword", " ", "is",
                   " ", "an", " ", "eigenvector", " ", "of", " ", "this", " ",
                   "Pauli", " ", "with", " ", "eigenvalue"}], " ", "+", 
                 RowBox[{"-", " ", "1"}]}]}], "  ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"X", " ", "=", " ", 
               RowBox[{"MakePauli", "[", 
                RowBox[{"avec", ",", "Svec"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"vecrot", " ", "=", " ", 
               RowBox[{"X", ".", "vecin"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"veck", " ", "=", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"vecin", " ", "+", " ", 
                  RowBox[{"sigmak", " ", "*", " ", "vecrot"}]}], ")"}], " ", 
                "/", " ", "2"}]}], ";"}], ",", " ", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{
               "This", " ", "runs", " ", "if", " ", "withProjections"}], " ", 
               "=", " ", "False"}], " ", "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"veck", " ", "=", " ", "vecin"}], ";"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"results", " ", "=", " ", 
            RowBox[{"Append", "[", 
             RowBox[{"results", ",", " ", 
              RowBox[{"{", 
               RowBox[{
               "Sestk", ",", " ", "veck", ",", " ", "signbitsk", ",", " ", 
                "metrick"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
          ")"}], " ", "&"}], "/@", " ", 
        RowBox[{"Range", "[", "newK", "]"}]}], ";", "\[IndentingNewLine]", 
       "results"}]}], "\[IndentingNewLine]", "]"}], "&"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.861942550141336*^9, 3.861942581428172*^9}, {
   3.861945358514812*^9, 3.8619453788373137`*^9}, {3.8619454512202463`*^9, 
   3.861945460411543*^9}, 3.861945516056163*^9, 3.8619559558701982`*^9, 
   3.861956475974897*^9, {3.8619566862547293`*^9, 3.861956686437563*^9}, {
   3.861956760222584*^9, 3.86195677365445*^9}, {3.8619624646422253`*^9, 
   3.861962469889051*^9}, {3.861962514754974*^9, 3.86196251518674*^9}, {
   3.863836975127016*^9, 3.863836985397792*^9}, {3.863837133621805*^9, 
   3.863837294054606*^9}, {3.8638373599423027`*^9, 3.863837529464834*^9}, {
   3.863837589143113*^9, 3.863837635335493*^9}, {3.863838062712365*^9, 
   3.863838065032633*^9}, {3.8638381364238777`*^9, 3.863838177016796*^9}, {
   3.863838224569521*^9, 3.863838238872982*^9}, {3.8638388725859013`*^9, 
   3.863838954665264*^9}, {3.863838991033783*^9, 3.8638389911294537`*^9}, {
   3.863839054521358*^9, 3.863839075593522*^9}, {3.8638391119775553`*^9, 
   3.8638391440737867`*^9}, {3.863839635019135*^9, 3.863839704908354*^9}, {
   3.8638399410084343`*^9, 3.86384012471576*^9}, {3.863840301260881*^9, 
   3.863840325981266*^9}, {3.8638438914896393`*^9, 3.863843975681172*^9}, {
   3.8638449620881357`*^9, 3.863845077203792*^9}, {3.863845148211934*^9, 
   3.863845172755512*^9}, {3.863845817592083*^9, 3.863845842628599*^9}, {
   3.863845924614588*^9, 3.863845933751474*^9}, {3.86384597621422*^9, 
   3.863845979134369*^9}, {3.863846031047687*^9, 3.8638460924864273`*^9}, {
   3.863846147920178*^9, 3.8638461758208*^9}, {3.86384623290384*^9, 
   3.863846235435459*^9}, {3.863846279877967*^9, 3.863846348038515*^9}, {
   3.863846554250739*^9, 3.8638465604452267`*^9}, {3.8638474882528973`*^9, 
   3.863847488423915*^9}, {3.8638487624439173`*^9, 3.863848801530581*^9}, {
   3.863848946523142*^9, 3.8638489682828217`*^9}, {3.8638490408122787`*^9, 
   3.863849077804606*^9}, {3.8638491166235647`*^9, 3.863849118316819*^9}, {
   3.863849236108515*^9, 3.86384929028386*^9}, {3.863852803935418*^9, 
   3.863852864147331*^9}, {3.8638529292522306`*^9, 3.8638529480517597`*^9}, {
   3.8638530132897673`*^9, 3.86385305155795*^9}, {3.863853161048798*^9, 
   3.863853161173255*^9}, {3.863853225081025*^9, 3.863853246867879*^9}, {
   3.863853430391423*^9, 3.863853487283839*^9}, {3.863853848121519*^9, 
   3.863853852501302*^9}, {3.863854068396023*^9, 3.863854086997876*^9}, {
   3.8638541713696117`*^9, 3.863854193518265*^9}, {3.863854299652832*^9, 
   3.8638543225174313`*^9}, {3.863854418697934*^9, 3.8638544623422537`*^9}, {
   3.863857969756269*^9, 3.863858004491333*^9}, {3.863858042695386*^9, 
   3.863858076262164*^9}, {3.8638585382848387`*^9, 3.863858576988085*^9}, {
   3.863858611147977*^9, 3.8638586789893723`*^9}, {3.863858728710478*^9, 
   3.86385873282915*^9}, {3.863858768276787*^9, 3.863858776588326*^9}, {
   3.863859111324986*^9, 3.863859137074542*^9}, {3.8638592495492287`*^9, 
   3.863859253696642*^9}, {3.863859420188973*^9, 3.8638594240310993`*^9}, {
   3.8638594771302156`*^9, 3.8638595027693768`*^9}, {3.863860034592832*^9, 
   3.863860063874457*^9}},ExpressionUUID->"c05a0ac2-d164-403f-ad37-\
8fd40ac3b907"]
}, Open  ]],

Cell[CellGroupData[{

Cell["List decoder", "Subsubsection",
 CellChangeTimes->{{3.8619427915972633`*^9, 3.861942817844078*^9}, 
   3.861942883486229*^9},ExpressionUUID->"fc7d9ba2-a645-41c5-8011-\
28d1f30c6ea6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BreadthFirstDecoding", " ", "=", " ", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "vecin", ",", " ", "ordering", ",", " ", "tt", ",", " ", "Sest", ",", 
         " ", "K", ",", " ", "candidatelist", ",", " ", "newcandidates", ",", 
         " ", "r", ",", " ", "inx", ",", " ", "jnx", ",", " ", "metrics", ",",
          " ", "peakinxs", ",", " ", "withProjections"}], "}"}], ",", " ", 
       RowBox[{
        RowBox[{"vecin", " ", "=", " ", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", 
        RowBox[{"ordering", " ", "=", " ", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", " ", 
        RowBox[{"K", " ", "=", " ", 
         RowBox[{"#", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ";", 
        RowBox[{"withProjections", " ", "=", " ", 
         RowBox[{"#", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tt", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{"True", ",", " ", 
           RowBox[{"2", "^", "mm"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Sest", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", "mm", "}"}], ",", 
           RowBox[{"{", "mm", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"candidatelist", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{"0", ",", 
              RowBox[{"{", "mm", "}"}], ",", 
              RowBox[{"{", "mm", "}"}]}], "]"}], ",", " ", "vecin", ",", " ", 
            
            RowBox[{"Table", "[", 
             RowBox[{"0", ",", " ", "mm"}], "]"}], ",", " ", 
            RowBox[{
             RowBox[{"Norm", "[", "vecin", "]"}], "^", "2"}]}], "}"}], 
          "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"inx", " ", "=", " ", "#"}], ";", "\[IndentingNewLine]", 
            RowBox[{"newcandidates", " ", "=", " ", 
             RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"r", " ", "=", " ", 
             RowBox[{"ordering", "[", 
              RowBox[{"[", "inx", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"jnx", " ", "=", " ", "#"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{
                  RowBox[{"FOR", " ", "FUTURE", " ", 
                   RowBox[{"DEVELOPEMENT", ":", " ", 
                    RowBox[{
                    "If", " ", "ordering", " ", "is", " ", "modified", " ", 
                    "during", " ", "the", " ", "run"}]}]}], ",", " ", 
                  RowBox[{
                  "this", " ", "needs", " ", "to", " ", "be", " ", 
                   "improved"}]}], " ", "*)"}], "\[IndentingNewLine]", 
                RowBox[{"newcandidates", " ", "=", " ", 
                 RowBox[{"Join", "[", 
                  RowBox[{"newcandidates", ",", 
                   RowBox[{"DecodeRowList", "[", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"candidatelist", "[", 
                    RowBox[{"[", "jnx", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "tt", ",", " ", "r", ",", " ", "K", ",", " ", 
                    "withProjections"}], "}"}]}], "]"}], "]"}]}], "]"}]}], 
                ";"}], "\[IndentingNewLine]", ")"}], "&"}], "/@", 
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "candidatelist", "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"metrics", " ", "=", " ", 
             RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"TODO", " ", "optimize"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"jnx", " ", "=", " ", "#"}], ";", " ", 
                RowBox[{"metrics", " ", "=", " ", 
                 RowBox[{"Append", "[", 
                  RowBox[{"metrics", ",", " ", 
                   RowBox[{"newcandidates", "[", 
                    RowBox[{"[", 
                    RowBox[{"jnx", ",", "4"}], "]"}], "]"}]}], "]"}]}], ";"}],
                ")"}], " ", "&"}], "/@", 
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "newcandidates", "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"peakinxs", " ", "=", " ", 
             RowBox[{"Reverse", "[", 
              RowBox[{"Ordering", "[", "metrics", "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"candidatelist", " ", "=", " ", 
             RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"TODO", " ", "optimize"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"jnx", " ", "=", " ", "#"}], ";", " ", 
                RowBox[{"candidatelist", " ", "=", " ", 
                 RowBox[{"Append", "[", 
                  RowBox[{"candidatelist", ",", " ", 
                   RowBox[{"newcandidates", "[", 
                    RowBox[{"[", 
                    RowBox[{"peakinxs", "[", 
                    RowBox[{"[", "jnx", "]"}], "]"}], "]"}], "]"}]}], "]"}]}],
                 ";"}], ")"}], "&"}], "/@", 
             RowBox[{"Range", "[", 
              RowBox[{"Min", "[", 
               RowBox[{"K", ",", " ", 
                RowBox[{"Length", "[", "newcandidates", "]"}]}], "]"}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"tt", " ", "=", " ", 
             RowBox[{"UpdateTruthTable", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"GiveTruthTable", "[", 
                 RowBox[{"{", 
                  RowBox[{"r", ",", " ", "mm"}], "}"}], "]"}], ",", " ", 
                "tt"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", ")"}], 
          "&"}], "/@", " ", 
         RowBox[{"Range", "[", "mm", "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"withProjections", ",", " ", 
          RowBox[{"posi", " ", "=", " ", "1"}], ",", " ", 
          RowBox[{
           RowBox[{"inners", " ", "=", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"best", " ", "=", " ", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], ";", " ", 
                RowBox[{"best", " ", "=", " ", 
                 RowBox[{"1", " ", "-", " ", "best"}]}], ";", " ", 
                RowBox[{"Sest", " ", "=", " ", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"vecest", " ", "=", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"cvec", " ", "=", " ", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"#", "-", "1"}], ",", "2", ",", "mm"}], "]"}]}], 
                    ";", 
                    RowBox[{
                    RowBox[{"(", "I", ")"}], "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"cvec", ".", "Sest", ".", "cvec"}], " ", "+", " ", 
                    RowBox[{"2", "*", 
                    RowBox[{"best", ".", "cvec"}]}]}], ")"}]}]}], ")"}], " ", 
                   "&"}], "/@", " ", 
                  RowBox[{"Range", "[", "Nn", "]"}]}]}], ";", " ", 
                RowBox[{"vecest", "  ", "=", " ", 
                 RowBox[{"vecest", "/", 
                  RowBox[{"Norm", "[", "vecest", "]"}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"Abs", "[", 
                 RowBox[{
                  RowBox[{"Conjugate", "[", "tstvec", "]"}], ".", "vecest"}], 
                 "]"}]}], "\[IndentingNewLine]", ")"}], " ", "&"}], "/@", " ",
              "candidatelist"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"posi", " ", "=", " ", 
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"inners", ",", 
               RowBox[{"Max", "[", "inners", "]"}]}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}]}], " ", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"candidatelist", "[", 
         RowBox[{"[", "posi", "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
     "&"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BreadthFirstDecodingNew", " ", "=", " ", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "vecin", ",", " ", "K", ",", " ", "R", ",", " ", "Peakinxs", ",", "  ",
         "WithProjections", ",", " ", "Orderation", ",", " ", "Tt", ",", " ", 
        "Sest", ",", " ", "Candidatelist", ",", " ", "Newcandidates"}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vecin", " ", "=", " ", "#1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"K", " ", "=", " ", "#2"}], ";", "\[IndentingNewLine]", 
       RowBox[{"WithProjections", " ", "=", " ", "#3"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Orderation", " ", "=", " ", "#4"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Tt", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{"True", ",", " ", 
          RowBox[{"2", "^", "mm"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Sest", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", "mm", "}"}], ",", 
          RowBox[{"{", "mm", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Candidatelist", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", "mm", "}"}], ",", 
             RowBox[{"{", "mm", "}"}]}], "]"}], ",", " ", 
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", " ", "mm"}], "]"}], ",", " ", "vecin", ",", " ", 
           RowBox[{
            RowBox[{"Norm", "[", "vecin", "]"}], "^", "2"}]}], "}"}], "}"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"R", " ", "=", " ", 
            RowBox[{"Orderation", "[", 
             RowBox[{"[", "#", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Newcandidates", " ", "=", " ", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Newcandidates", " ", "=", " ", 
                RowBox[{"Join", "[", 
                 RowBox[{"Newcandidates", ",", 
                  RowBox[{"DecodeRowListNew", " ", "@@", " ", 
                   RowBox[{"Join", "[", 
                    RowBox[{"#", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    "Tt", ",", " ", "WithProjections", ",", " ", "K", ",", 
                    " ", "R"}], "}"}]}], "]"}]}]}], "]"}]}], ";"}], " ", 
              ")"}], "&"}], "/@", "Candidatelist"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Peakinxs", " ", "=", " ", 
            RowBox[{"Take", "[", 
             RowBox[{
              RowBox[{"Reverse", "[", 
               RowBox[{"Ordering", "[", 
                RowBox[{"Newcandidates", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", " ", "4"}], "]"}], "]"}], "]"}], "]"}], 
              ",", " ", 
              RowBox[{"Min", "[", 
               RowBox[{"K", ",", " ", 
                RowBox[{"Length", "[", "Newcandidates", "]"}]}], "]"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Candidatelist", " ", "=", " ", 
            RowBox[{"Newcandidates", "[", 
             RowBox[{"[", "Peakinxs", "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Tt", " ", "=", " ", 
            RowBox[{"UpdateTruthTableNew", "[", 
             RowBox[{"Tt", ",", " ", "R"}], "]"}]}], ";"}], 
          "\[IndentingNewLine]", ")"}], "&"}], "/@", 
        RowBox[{"Range", "[", "mm", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Candidatelist", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
    "&"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8619425938836718`*^9, 3.861942630189619*^9}, 
   3.86194272133255*^9, {3.861942769834145*^9, 3.861942791597353*^9}, 
   3.8619428834863873`*^9, {3.8619437963435717`*^9, 3.861943796815851*^9}, 
   3.861959777707698*^9, 3.861959809148654*^9, 3.861962289562769*^9, {
   3.86196237354668*^9, 3.861962374575366*^9}, {3.8638464597941923`*^9, 
   3.8638465231525583`*^9}, {3.863846605696742*^9, 3.8638466571524143`*^9}, {
   3.863846688624827*^9, 3.863846719777686*^9}, {3.863846755889172*^9, 
   3.8638467809613132`*^9}, {3.863847009953538*^9, 3.863847104235859*^9}, {
   3.863847623203814*^9, 3.86384770501134*^9}, {3.863847787381153*^9, 
   3.8638478215877323`*^9}, {3.863847859779046*^9, 3.863847864212075*^9}, {
   3.8638479245636578`*^9, 3.863848056419709*^9}, {3.863848130196521*^9, 
   3.863848136005233*^9}, {3.863848210405703*^9, 3.8638482163881693`*^9}, {
   3.863848440421339*^9, 3.863848619260633*^9}, {3.86384946880617*^9, 
   3.863849510855433*^9}, {3.863849874019211*^9, 3.863849889256112*^9}, {
   3.8638500486000357`*^9, 3.86385007976754*^9}, {3.8638505830168324`*^9, 
   3.863850597240685*^9}, {3.8638508516254797`*^9, 3.863850955897315*^9}, {
   3.863851031545333*^9, 3.863851042921842*^9}, {3.863851095385466*^9, 
   3.8638511615135307`*^9}, {3.863851601130403*^9, 3.863851632924645*^9}, {
   3.86385185540699*^9, 3.863851866075437*^9}, {3.863851923003933*^9, 
   3.863851971611992*^9}, {3.8638520278895206`*^9, 3.8638520665404778`*^9}, {
   3.8638599503598967`*^9, 
   3.8638599512661743`*^9}},ExpressionUUID->"b7d465eb-be74-4b48-858a-\
39689fbcc7c8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Simulation", "Subsection",
 CellChangeTimes->{{3.8619431413585052`*^9, 
  3.861943144907546*^9}},ExpressionUUID->"fcba4a3e-c55c-4b6b-8b3b-\
21b960e5cb8f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Smat", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "1"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", " ", 
  RowBox[{"Smat", " ", "//", "mf"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bvec", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ";", " ", 
  RowBox[{"bvec", "//", "mf"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tstvec", " ", "=", " ", 
   RowBox[{"GenerateChirp", "[", 
    RowBox[{"Smat", ",", " ", "bvec"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.861944904106223*^9, 3.861944961639081*^9}, {
  3.861945004033059*^9, 3.861945042199627*^9}, {3.861945081096702*^9, 
  3.86194508455482*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"d479db40-5cd3-457c-882c-4fa00c3337fc"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "1"},
     {"1", "0", "0"},
     {"1", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.86194493008694*^9, 3.861944962064588*^9}, {
   3.8619450134442263`*^9, 3.861945043555436*^9}, 3.8619450849330883`*^9, {
   3.861945465286668*^9, 3.861945490330187*^9}, {3.861955202764947*^9, 
   3.861955229574606*^9}, 3.861955280228175*^9, 3.861955311668593*^9, 
   3.861955540325111*^9, 3.8619559606318817`*^9, 3.861956025819407*^9, 
   3.861956495681308*^9, 3.86195679710973*^9, 3.861962307031007*^9, 
   3.861962564681869*^9, 3.8619633782396097`*^9},
 CellLabel->
  "Out[24]//MatrixForm=",ExpressionUUID->"39573260-86e5-4285-9ae4-\
b8ed941a9ac5"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"0"},
      {"1"},
      {"0"}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.86194493008694*^9, 3.861944962064588*^9}, {
   3.8619450134442263`*^9, 3.861945043555436*^9}, 3.8619450849330883`*^9, {
   3.861945465286668*^9, 3.861945490330187*^9}, {3.861955202764947*^9, 
   3.861955229574606*^9}, 3.861955280228175*^9, 3.861955311668593*^9, 
   3.861955540325111*^9, 3.8619559606318817`*^9, 3.861956025819407*^9, 
   3.861956495681308*^9, 3.86195679710973*^9, 3.861962307031007*^9, 
   3.861962564681869*^9, 3.8619633782858763`*^9},
 CellLabel->
  "Out[25]//MatrixForm=",ExpressionUUID->"93251719-09ae-41b3-aadf-\
ca7b22fe7899"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Sest", ",", " ", "zleft", ",", " ", "best", ",", " ", "metric"}],
     "}"}], " ", "=", " ", 
   RowBox[{"BreadthFirstDecoding", "[", 
    RowBox[{"{", 
     RowBox[{"tstvec", ",", " ", 
      RowBox[{"Range", "[", "mm", "]"}], ",", " ", "1", ",", " ", "False"}], 
     "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vecest", " ", "=", " ", 
   RowBox[{"Conjugate", "[", 
    RowBox[{"GenerateChirp", "[", 
     RowBox[{"Sest", ",", " ", "bvec"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Sest", " ", "//", " ", "mf"}]}], "Input",
 CellChangeTimes->{{3.8619450356228943`*^9, 3.861945072064*^9}, {
  3.861945215703849*^9, 3.8619452251203833`*^9}, {3.861945281225028*^9, 
  3.861945299565092*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"b84d3c9c-8cac-4561-a8b9-536ccf8d93fc"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "1"},
     {"1", "0", "0"},
     {"1", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8619450667705307`*^9, 3.861945087378475*^9}, 
   3.861945225721283*^9, {3.8619452815773163`*^9, 3.861945300712907*^9}, {
   3.861945465321383*^9, 3.861945490412964*^9}, {3.8619552028564167`*^9, 
   3.8619552296177797`*^9}, 3.861955280284526*^9, 3.861955311707213*^9, 
   3.861955540376087*^9, 3.86195596070087*^9, 3.861956025914431*^9, 
   3.861956495742465*^9, 3.861956797153202*^9, 3.861962309550297*^9, 
   3.861962564796245*^9, 3.861963378370607*^9},
 CellLabel->
  "Out[29]//MatrixForm=",ExpressionUUID->"eed34e0b-d4a7-42d9-a85c-\
79a723112519"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Abs", "[", 
     RowBox[{"tstvec", ".", "vecest"}], "]"}], ">", " ", "0.99"}], ",", "1", 
   ",", "0"}], "]"}]], "Input",
 CellChangeTimes->{{3.861945308100409*^9, 3.8619453193205442`*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"16075d6e-f6e2-415b-afbc-0e6cd5c1c95b"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.861945320166575*^9, 3.861945322120352*^9}, {
   3.861945465342515*^9, 3.861945490468351*^9}, {3.861955202906291*^9, 
   3.8619552296755123`*^9}, 3.861955280351488*^9, 3.861955311746356*^9, 
   3.861955540442964*^9, 3.8619559607511883`*^9, 3.8619560259923983`*^9, 
   3.8619564958079233`*^9, 3.861956797199069*^9, 3.861962564900694*^9, 
   3.861963378491989*^9},
 CellLabel->"Out[30]=",ExpressionUUID->"82d07b45-18ce-4469-97d8-de9fac6b29c8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"bvec", " ", "//", " ", "mf"}]], "Input",
 CellChangeTimes->{{3.861945074323196*^9, 3.8619450764641113`*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"9309cc1c-20ef-4aa2-9658-c15f16fecdce"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"0"},
      {"1"},
      {"0"}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.861945076731509*^9, {3.861945465368642*^9, 3.8619454905329437`*^9}, {
   3.861955202967401*^9, 3.861955229730259*^9}, 3.861955280415812*^9, 
   3.861955311826907*^9, 3.8619555404795933`*^9, 3.8619559607811203`*^9, 
   3.861956026074792*^9, 3.861956495877832*^9, 3.8619567972407293`*^9, 
   3.861962565031992*^9, 3.861963378609079*^9},
 CellLabel->
  "Out[31]//MatrixForm=",ExpressionUUID->"61086251-fba5-46d0-b951-\
b001007954b2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1", ",", "0"}], "}"}], "]"}]], "Input",
 NumberMarks->False,
 CellLabel->"In[32]:=",ExpressionUUID->"acc5cd94-fa39-4fe3-be3e-8a8fe2599074"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.861954927593198*^9, {3.8619552030349703`*^9, 3.861955229757914*^9}, 
   3.861955280471941*^9, 3.861955311897086*^9, 3.8619555405111637`*^9, 
   3.861955960804749*^9, 3.861956026129408*^9, 3.861956495918223*^9, 
   3.861956797280903*^9, 3.861962565238803*^9, 3.8619633787147913`*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"fc7890b9-58df-47ea-9f69-3743e44c3658"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Creates", " ", "upper", " ", "triangular", " ", "matrix", " ", "from", 
    " ", "vector"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"upperTriangular", "[", "v_", "]"}], ":=", 
    RowBox[{"upperTriangular", "[", 
     RowBox[{"v", ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"1", "+", 
           RowBox[{"8", "*", 
            RowBox[{"Length", "@", "v"}]}]}], "]"}]}], ")"}], "/", "2"}]}], 
     "]"}]}], "\n", 
   RowBox[{
    RowBox[{"upperTriangular", "[", 
     RowBox[{"v_", ",", "n_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", "=", "0"}], "}"}], ",", 
      RowBox[{"Array", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"#", ">=", "#2"}], ",", "0", ",", 
           RowBox[{"v", "[", 
            RowBox[{"[", 
             RowBox[{"++", "i"}], "]"}], "]"}]}], "]"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"upperTriangulizer", "[", 
     RowBox[{"n_Integer", ",", 
      RowBox[{"type_", ":", "_Integer"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v", ",", "r"}], "}"}], ",", 
      RowBox[{"Quiet", "[", 
       RowBox[{
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"r", "=", 
            RowBox[{"upperTriangular", "[", 
             RowBox[{"v", ",", "n"}], "]"}]}], "}"}], ",", 
          RowBox[{"Compile", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"v", ",", "type", ",", "1"}], "}"}], "}"}], ",", "r"}], 
           "]"}]}], "]"}], ",", 
        RowBox[{"Part", "::", "partd"}]}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Example", " ", "printed", " ", "below"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"upperTriangulizer", "[", "3", "]"}], " ", "@", " ", 
      RowBox[{"Range", "[", "3", "]"}]}], " ", "//", " ", "MatrixForm"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ExtendedSymmetricMats", "=", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "size", ",", " ", "diag", ",", " ", "diagmat", ",", " ", "triuvec", 
          ",", " ", "triumat", ",", " ", "result", ",", " ", "results", ",", 
          " ", "inx"}], "}"}], ",", 
        RowBox[{
         RowBox[{"size", "=", "#"}], ";", "\[IndentingNewLine]", 
         RowBox[{"results", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"inx", "=", "#"}], ";", "\[IndentingNewLine]", 
             RowBox[{"diag", "=", 
              RowBox[{"IntegerDigits", "[", 
               RowBox[{
                RowBox[{"Mod", "[", 
                 RowBox[{"inx", ",", 
                  RowBox[{"2", "^", "size"}]}], "]"}], ",", "2", ",", 
                "size"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"diagmat", "=", 
              RowBox[{"DiagonalMatrix", "[", "diag", "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"triuvec", "=", 
              RowBox[{"IntegerDigits", "[", 
               RowBox[{
                RowBox[{"Floor", "[", 
                 RowBox[{"inx", "/", 
                  RowBox[{"(", 
                   RowBox[{"2", "^", "size"}], ")"}]}], "]"}], ",", "4", ",", 
                " ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"size", " ", "-", " ", "1"}], ")"}], "*", 
                 RowBox[{"size", " ", "/", " ", "2"}]}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"triumat", "=", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"upperTriangulizer", "[", "size", "]"}], "@", 
                 "triuvec"}], ")"}], "/", "2"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"result", "=", 
              RowBox[{"triumat", "+", 
               RowBox[{"Transpose", "[", "triumat", "]"}], "+", "diagmat"}]}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"results", ",", "result"}], "]"}], ";"}], ")"}], "&"}], 
          "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"2", "^", 
              RowBox[{"(", 
               RowBox[{"size", "^", "2"}], ")"}]}], "-", "1"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", "results"}]}], "\[IndentingNewLine]", 
       "]"}], "&"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ExtendedSmats", " ", "=", " ", 
     RowBox[{"ExtendedSymmetricMats", "[", "mm", "]"}]}], ";", " ", 
    RowBox[{"ExtendedSmats", " ", "//", " ", "mfl"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AllBinSymm", " ", "=", " ", 
     RowBox[{"GenerateSn2", "[", "mm", "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.861954931665844*^9, 3.86195495275695*^9}, {
  3.86195498301737*^9, 3.861955007054587*^9}, {3.861963043992947*^9, 
  3.8619630453513947`*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"cfb00114-724f-49b7-bc1b-66b8d94f6a60"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Smatrix", "=", 
   RowBox[{"ExtendedSmats", "[", 
    RowBox[{"[", "37", "]"}], "]"}]}], ";", " ", 
  RowBox[{"Smatrix", " ", "//", " ", "mf"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bvec", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"chirp", " ", "=", " ", 
   RowBox[{"GenerateChirp", "[", 
    RowBox[{"Smatrix", ",", " ", "bvec"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Sestimate", ",", "bestimate"}], "}"}], "=", 
   RowBox[{"ExtendedDecoder", "[", "chirp", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sestimate", " ", "//", " ", "mf"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bestimate", " ", "//", "mf"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Smatrix", "=", "#"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"bvector", "=", 
             RowBox[{"IntegerDigits", "[", 
              RowBox[{
               RowBox[{"#", "-", "1"}], ",", "2", ",", "mm"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"chirp", "=", 
             RowBox[{"GenerateChirp", "[", 
              RowBox[{"Smatrix", ",", "bvector"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Sestimate", ",", "bestimate"}], "}"}], "=", 
             RowBox[{"ExtendedDecoder", "[", "chirp", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Union", "[", 
                RowBox[{"Flatten", "[", 
                 RowBox[{"Sestimate", "-", "Smatrix"}], "]"}], "]"}], "!=", 
               RowBox[{"{", "0", "}"}]}], ",", 
              RowBox[{"Print", "[", "\"\<Decoder failed\>\"", "]"}]}], "]"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Union", "[", 
                RowBox[{"bestimate", "-", "bvector"}], "]"}], "!=", 
               RowBox[{"{", "0", "}"}]}], ",", 
              RowBox[{"Print", "[", "\"\<Decoder failed\>\"", "]"}]}], "]"}], 
            ";"}], "\[IndentingNewLine]", ")"}], "&"}], "/@", 
         RowBox[{"Range", "[", "Nn", "]"}]}], ";"}], " ", ")"}], "&"}], "/@", 
     "ExtendedSmats"}], ";"}], " ", "\[IndentingNewLine]", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", " ", "practical", " ", "purposes"}], ",", 
    RowBox[{
     RowBox[{"we", " ", "would", " ", "have", " ", "K"}], ">>", 
     RowBox[{"1", " ", "codewords", " ", "sent", " ", "simultaneously"}]}], 
    ",", 
    RowBox[{"and", " ", "then", " ", "some", " ", 
     RowBox[{"noise", ".", "You"}], " ", "could", " ", "model", " ", "the", 
     " ", "channel", " ", "as", "\n", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"y", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"sqrt", "[", 
         RowBox[{"N", "*", "gamma"}], "]"}], "*", 
        RowBox[{"(", 
         RowBox[{"sum_", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", "=", "1"}], "}"}], "^", "K"}], " ", "w_i"}], ")"}]}],
        "+", "noise"}]}]}], ",", 
    RowBox[{
    "where", " ", "w_i", " ", "are", " ", "codewords", " ", "in", " ", "N", 
     " ", "dimensions"}], ",", 
    RowBox[{"noise", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"randn", 
         RowBox[{"(", 
          RowBox[{"N", ",", "1"}], ")"}]}], "+", 
        RowBox[{"1", "i", "*", "randn", 
         RowBox[{"(", 
          RowBox[{"N", ",", "1"}], ")"}]}]}], ")"}], "/", 
      RowBox[{"sqrt", "[", "2", "]"}]}]}], ",", 
    RowBox[{"and", " ", "gamma", " ", "is", " ", "real", " ", "number", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"SNR", "=", 
        RowBox[{"10", "*", 
         RowBox[{"log10", "[", "gamma", "]"}]}]}], ",", "so", ",", 
       RowBox[{"for", " ", "instance"}], ",", 
       RowBox[{"gamma", "=", 
        RowBox[{
         RowBox[{"100", " ", "gives", " ", "SNR"}], "=", "20"}]}], ",", 
       RowBox[{"gamma", "=", 
        RowBox[{
         RowBox[{"10", " ", "gives", " ", "SNR"}], "=", 
         RowBox[{"10", " ", "etc"}]}]}]}], ")"}], " ", "that", " ", 
     "controls", " ", "the", " ", 
     RowBox[{"power", "."}]}]}], "\[IndentingNewLine]", "*)"}]}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQXbZ573/RY28cA/dC6BSmLyxiQHrGPmFWEB2Sm2Ej
AaSrF0FotpP7HUH0FJMTQSC6ahNDK4hOO+vVDqJ36EdNBdERh4PmgOgzKatP
gejpszlPg+jdiQyfQbTBVS4wzcYjIykJpK+268uCaJ1jFiogWtA8TxVEa59r
1AXRTTUC+iB6GquVJYg+9eS0NYi2UnntDqL3XdjrA6Kz4n5VguhL2qINYPVR
e1eB6MbbC9eD6DLu/O0g+t3zTRdB9N6jl6+C6JqrzddAdMOHjLtgc++8B9Oz
enY8AvMdDj0D0bdWfK2TBrn7oWc9iC6cwNEHouflnJ4Eome0Kp0F0Veea4Lp
JdOUP4Ho3z6NYLrv5hEfGSB9o6DOF0QDALHWx5c=
  "],
 CellLabel->"In[29]:=",ExpressionUUID->"e09ef87e-43f3-4b2a-86fa-eff8b0d4c154"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", 
      FractionBox["1", "2"]},
     {"0", "0", "0"},
     {
      FractionBox["1", "2"], "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.861962337207096*^9, 3.861962354609424*^9}, 
   3.8619624811838207`*^9, 3.8619625656557083`*^9, 3.861962645481715*^9, 
   3.8619633791504173`*^9, 3.863251664853964*^9},
 CellLabel->
  "Out[29]//MatrixForm=",ExpressionUUID->"5cd11531-b8a2-4ad7-8613-\
37715f26615f"],

Cell[BoxData[
 TemplateBox[{
  "Pick", "incomp", 
   "\"Expressions \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \
\\\"2\\\", \\\",\\\", \\\"3\\\", \\\",\\\", \\\"4\\\", \\\",\\\", \\\"5\\\", \
\\\",\\\", \\\"6\\\", \\\",\\\", \\\"7\\\", \\\",\\\", \\\"8\\\"}], \
\\\"}\\\"}]\\) and \\!\\(\\*RowBox[{\\\"UpdateTruthTable\\\", \\\"[\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"GiveTruthTable\\\", \\\"[\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"3\\\"}], \\\"}\\\"}], \\\
\"]\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"True\\\", \\\",\\\", \
\\\"True\\\", \\\",\\\", \\\"True\\\", \\\",\\\", \\\"True\\\", \\\",\\\", \\\
\"True\\\", \\\",\\\", \\\"True\\\", \\\",\\\", \\\"True\\\", \\\",\\\", \
\\\"True\\\"}], \\\"}\\\"}]}], \\\"}\\\"}], \\\"]\\\"}]\\) have incompatible \
shapes.\"", 2, 32, 1, 21351245438561967887, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.863251664954393*^9},
 CellLabel->
  "During evaluation of \
In[29]:=",ExpressionUUID->"7adf6a16-c803-44b1-81ae-9159919d3c44"],

Cell[BoxData[
 TemplateBox[{
  "Part", "pkspec1", 
   "\"The expression \\!\\(\\*RowBox[{\\\"Pick\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"2\\\", \
\\\",\\\", \\\"3\\\", \\\",\\\", \\\"4\\\", \\\",\\\", \\\"5\\\", \\\",\\\", \
\\\"6\\\", \\\",\\\", \\\"7\\\", \\\",\\\", \\\"8\\\"}], \\\"}\\\"}], \\\",\\\
\", RowBox[{\\\"UpdateTruthTable\\\", \\\"[\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"GiveTruthTable\\\", \\\"[\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"1\\\", \\\",\\\", \\\"3\\\"}], \\\"}\\\"}], \\\"]\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"True\\\", \\\",\\\", \\\"True\\\", \
\\\",\\\", \\\"True\\\", \\\",\\\", \\\"True\\\", \\\",\\\", \\\"True\\\", \\\
\",\\\", \\\"True\\\", \\\",\\\", \\\"True\\\", \\\",\\\", \\\"True\\\"}], \\\
\"}\\\"}]}], \\\"}\\\"}], \\\"]\\\"}]}], \\\"]\\\"}]\\) cannot be used as a \
part specification.\"", 2, 32, 2, 21351245438561967887, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.863251665070442*^9},
 CellLabel->
  "During evaluation of \
In[29]:=",ExpressionUUID->"40549bad-41e0-4623-abf9-fee5bf047c15"],

Cell[BoxData[
 TemplateBox[{
  "Pick", "argt", 
   "\"\\!\\(\\*RowBox[{\\\"Pick\\\"}]\\) called with \\!\\(\\*RowBox[{\\\"8\\\
\"}]\\) arguments; \\!\\(\\*RowBox[{\\\"2\\\"}]\\) or \
\\!\\(\\*RowBox[{\\\"3\\\"}]\\) arguments are expected.\"", 2, 32, 3, 
   21351245438561967887, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.86325166507661*^9},
 CellLabel->
  "During evaluation of \
In[29]:=",ExpressionUUID->"1b857e46-ac02-4e28-afad-cc5f1507df15"],

Cell[BoxData[
 TemplateBox[{
  "Part", "partw", 
   "\"Part \\!\\(\\*RowBox[{\\\"1\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
\\\"}\\\"}]\\) does not exist.\"", 2, 32, 4, 21351245438561967887, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.863251665087475*^9},
 CellLabel->
  "During evaluation of \
In[29]:=",ExpressionUUID->"ddbfbb54-ddc7-45ba-9b86-4bc07f114afd"],

Cell[BoxData[
 TemplateBox[{
  "Part", "pkspec1", 
   "\"The expression \\!\\(\\*RowBox[{RowBox[{\\\"{\\\", \\\"}\\\"}], \\\"\
\[LeftDoubleBracket]\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"1\\\"}], \\\"\
\[RightDoubleBracket]\\\"}]\\) cannot be used as a part specification.\"", 2, 
   32, 5, 21351245438561967887, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.86325166509263*^9},
 CellLabel->
  "During evaluation of \
In[29]:=",ExpressionUUID->"2f4fbb6f-dd7a-4a71-8047-e3ff49774f53"],

Cell[BoxData[
 TemplateBox[{
  "Part", "pkspec1", 
   "\"The expression \\!\\(\\*RowBox[{RowBox[{\\\"{\\\", \\\"}\\\"}], \\\"\
\[LeftDoubleBracket]\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"1\\\"}], \\\"\
\[RightDoubleBracket]\\\"}]\\) cannot be used as a part specification.\"", 2, 
   32, 6, 21351245438561967887, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8632516650985928`*^9},
 CellLabel->
  "During evaluation of \
In[29]:=",ExpressionUUID->"80c3f01b-4592-4b92-b47a-9d0091ed7508"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Part\\\", \\\"::\\\", \
\\\"pkspec1\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"", 2, 32, 7, 21351245438561967887, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8632516651035433`*^9},
 CellLabel->
  "During evaluation of \
In[29]:=",ExpressionUUID->"c870ce78-6a5b-4c4d-9471-ae76fd993134"],

Cell[BoxData[
 TemplateBox[{
  "Transpose", "nmtx", 
   "\"The first two levels of \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"1\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"IntegerDigits\\\", \\\"[\\\", RowBox[{RowBox[{RowBox[{\\\"-\\\", \
\\\"1\\\"}], \\\"+\\\", RowBox[{RowBox[{\\\"{\\\", \\\"}\\\"}], \\\"\
\[LeftDoubleBracket]\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"1\\\"}], \\\"\
\[RightDoubleBracket]\\\"}]}], \\\",\\\", \\\"2\\\", \\\",\\\", \\\"3\\\"}], \
\\\"]\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]\\) cannot be \
transposed.\"", 2, 32, 8, 21351245438561967887, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.86325166510938*^9},
 CellLabel->
  "During evaluation of \
In[29]:=",ExpressionUUID->"6f6045ec-89e3-4248-a7f0-11b4225b7f6c"],

Cell[BoxData[
 TemplateBox[{
  "Part", "partw", 
   "\"Part \\!\\(\\*RowBox[{\\\"3\\\"}]\\) of \
\\!\\(\\*RowBox[{\\\"Transpose\\\", \\\"[\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"1\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"IntegerDigits\\\", \\\"[\\\", RowBox[{RowBox[{RowBox[{\\\"-\\\", \
\\\"1\\\"}], \\\"+\\\", RowBox[{RowBox[{\\\"{\\\", \\\"}\\\"}], \\\"\
\[LeftDoubleBracket]\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"1\\\"}], \\\"\
\[RightDoubleBracket]\\\"}]}], \\\",\\\", \\\"2\\\", \\\",\\\", \\\"3\\\"}], \
\\\"]\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\"}]}], \\\"}\\\"}], \\\"]\\\"}]\\) \
does not exist.\"", 2, 32, 9, 21351245438561967887, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.863251665115179*^9},
 CellLabel->
  "During evaluation of \
In[29]:=",ExpressionUUID->"c8de1225-3034-459e-9bc4-521017dc2a54"],

Cell[BoxData[
 TemplateBox[{
  "Pick", "incomp", 
   "\"Expressions \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \
\\\"2\\\", \\\",\\\", \\\"3\\\", \\\",\\\", \\\"4\\\", \\\",\\\", \\\"5\\\", \
\\\",\\\", \\\"6\\\", \\\",\\\", \\\"7\\\", \\\",\\\", \\\"8\\\"}], \
\\\"}\\\"}]\\) and \\!\\(\\*RowBox[{\\\"UpdateTruthTable\\\", \\\"[\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"GiveTruthTable\\\", \\\"[\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"2\\\", \\\",\\\", \\\"3\\\"}], \\\"}\\\"}], \\\
\"]\\\"}], \\\",\\\", RowBox[{\\\"UpdateTruthTable\\\", \\\"[\\\", RowBox[{\\\
\"{\\\", RowBox[{RowBox[{\\\"GiveTruthTable\\\", \\\"[\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"3\\\"}], \\\"}\\\"}], \\\
\"]\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"True\\\", \\\",\\\", \
\\\"True\\\", \\\",\\\", \\\"True\\\", \\\",\\\", \\\"True\\\", \\\",\\\", \\\
\"True\\\", \\\",\\\", \\\"True\\\", \\\",\\\", \\\"True\\\", \\\",\\\", \
\\\"True\\\"}], \\\"}\\\"}]}], \\\"}\\\"}], \\\"]\\\"}]}], \\\"}\\\"}], \\\"]\
\\\"}]\\) have incompatible shapes.\"", 2, 32, 10, 21351245438561967887, 
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.863251665120376*^9},
 CellLabel->
  "During evaluation of \
In[29]:=",ExpressionUUID->"d7ecd4dc-df7a-46ae-8673-afb56e9c6a45"],

Cell[BoxData[
 TemplateBox[{
  "FromDigits", "nlst", 
   "\"The expression \\!\\(\\*RowBox[{RowBox[{\\\"Transpose\\\", \\\"[\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"IntegerDigits\\\", \\\"[\\\", RowBox[{RowBox[{RowBox[{\\\"-\\\", \
\\\"1\\\"}], \\\"+\\\", RowBox[{RowBox[{\\\"{\\\", \\\"}\\\"}], \\\"\
\[LeftDoubleBracket]\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"1\\\"}], \\\"\
\[RightDoubleBracket]\\\"}]}], \\\",\\\", \\\"2\\\", \\\",\\\", \\\"3\\\"}], \
\\\"]\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\"}]}], \\\"}\\\"}], \\\"]\\\"}], \
\\\"\[LeftDoubleBracket]\\\", \\\"3\\\", \\\"\[RightDoubleBracket]\\\"}]\\) \
is not a list of digits or a string of valid digits.\"", 2, 32, 11, 
   21351245438561967887, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.863251665144513*^9},
 CellLabel->
  "During evaluation of \
In[29]:=",ExpressionUUID->"b60cd53d-96b2-407d-960c-8c629cf5055e"],

Cell[BoxData[
 TemplateBox[{
  "Part", "partw", 
   "\"Part \\!\\(\\*RowBox[{\\\"1\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
\\\"}\\\"}]\\) does not exist.\"", 2, 32, 12, 21351245438561967887, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.863251665161118*^9},
 CellLabel->
  "During evaluation of \
In[29]:=",ExpressionUUID->"819164fe-dc0e-45e1-8ef3-c7adf86d6f8a"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Part\\\", \\\"::\\\", \
\\\"partw\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"", 2, 32, 13, 21351245438561967887, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.863251665166526*^9},
 CellLabel->
  "During evaluation of \
In[29]:=",ExpressionUUID->"5b1f0da0-ccc0-4dbf-bfa7-0dfb262e49a6"],

Cell[BoxData[
 TemplateBox[{
  "Dot", "rect", "\"Nonrectangular tensor encountered.\"", 2, 32, 14, 
   21351245438561967887, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.863251665238018*^9},
 CellLabel->
  "During evaluation of \
In[29]:=",ExpressionUUID->"a5bab238-c578-4381-a9a7-2d37cc2c98ac"],

Cell[BoxData[
 TemplateBox[{
  "Dot", "rect", "\"Nonrectangular tensor encountered.\"", 2, 32, 15, 
   21351245438561967887, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.863251665247713*^9},
 CellLabel->
  "During evaluation of \
In[29]:=",ExpressionUUID->"babe5412-c0a7-467e-b8aa-d21775f8eb4f"],

Cell[BoxData[
 TemplateBox[{
  "Dot", "rect", "\"Nonrectangular tensor encountered.\"", 2, 32, 16, 
   21351245438561967887, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.863251665257811*^9},
 CellLabel->
  "During evaluation of \
In[29]:=",ExpressionUUID->"44fa4008-4491-40ef-aa8e-48c76ae767ae"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Dot\\\", \\\"::\\\", \\\
\"rect\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"", 2, 32, 17, 21351245438561967887, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.863251665275489*^9},
 CellLabel->
  "During evaluation of \
In[29]:=",ExpressionUUID->"aa67e7c3-7638-49d3-be0e-747f85b3cc96"],

Cell[BoxData[
 TemplateBox[{
  "Pick", "incomp", 
   "\"Expressions \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \
\\\"2\\\", \\\",\\\", \\\"3\\\", \\\",\\\", \\\"4\\\", \\\",\\\", \\\"5\\\", \
\\\",\\\", \\\"6\\\", \\\",\\\", \\\"7\\\", \\\",\\\", \\\"8\\\"}], \
\\\"}\\\"}]\\) and \\!\\(\\*RowBox[{\\\"UpdateTruthTable\\\", \\\"[\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"GiveTruthTable\\\", \\\"[\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"3\\\"}], \\\"}\\\"}], \\\
\"]\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"True\\\", \\\",\\\", \
\\\"True\\\", \\\",\\\", \\\"True\\\", \\\",\\\", \\\"True\\\", \\\",\\\", \\\
\"True\\\", \\\",\\\", \\\"True\\\", \\\",\\\", \\\"True\\\", \\\",\\\", \
\\\"True\\\"}], \\\"}\\\"}]}], \\\"}\\\"}], \\\"]\\\"}]\\) have incompatible \
shapes.\"", 2, 32, 18, 21351245438561967887, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.863251665286146*^9},
 CellLabel->
  "During evaluation of \
In[29]:=",ExpressionUUID->"37222b7a-fe7c-47ad-bea5-ae48fe5c8ded"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Pick\\\", \\\"::\\\", \
\\\"incomp\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"", 2, 32, 19, 21351245438561967887, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.863251665293944*^9},
 CellLabel->
  "During evaluation of \
In[29]:=",ExpressionUUID->"a3973774-39d5-4e3d-9547-3fbc65fe6014"],

Cell[BoxData[
 TemplateBox[{
  "Transpose", "nmtx", 
   "\"The first two levels of \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"1\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"IntegerDigits\\\", \\\"[\\\", RowBox[{RowBox[{RowBox[{\\\"-\\\", \
\\\"1\\\"}], \\\"+\\\", RowBox[{RowBox[{\\\"{\\\", \\\"}\\\"}], \\\"\
\[LeftDoubleBracket]\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"1\\\"}], \\\"\
\[RightDoubleBracket]\\\"}]}], \\\",\\\", \\\"2\\\", \\\",\\\", \\\"3\\\"}], \
\\\"]\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]\\) cannot be \
transposed.\"", 2, 32, 20, 21351245438561967887, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.863251665323491*^9},
 CellLabel->
  "During evaluation of \
In[29]:=",ExpressionUUID->"df5ed79c-8041-49d5-b223-127c464df171"],

Cell[BoxData[
 TemplateBox[{
  "FromDigits", "nlst", 
   "\"The expression \\!\\(\\*RowBox[{RowBox[{\\\"Transpose\\\", \\\"[\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"IntegerDigits\\\", \\\"[\\\", RowBox[{RowBox[{RowBox[{\\\"-\\\", \
\\\"1\\\"}], \\\"+\\\", RowBox[{RowBox[{\\\"{\\\", \\\"}\\\"}], \\\"\
\[LeftDoubleBracket]\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"1\\\"}], \\\"\
\[RightDoubleBracket]\\\"}]}], \\\",\\\", \\\"2\\\", \\\",\\\", \\\"3\\\"}], \
\\\"]\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\"}]}], \\\"}\\\"}], \\\"]\\\"}], \
\\\"\[LeftDoubleBracket]\\\", \\\"3\\\", \\\"\[RightDoubleBracket]\\\"}]\\) \
is not a list of digits or a string of valid digits.\"", 2, 32, 21, 
   21351245438561967887, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.863251665390242*^9},
 CellLabel->
  "During evaluation of \
In[29]:=",ExpressionUUID->"f28af790-4d4e-4a59-a6b9-c51e0dbdc3f1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Timing", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"drops", " ", "=", " ", 
    RowBox[{"1125", "*", "100"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"SNRValues", " ", "=", " ", 
    RowBox[{"Range", "[", 
     RowBox[{
      RowBox[{"-", "10"}], ",", "15", ",", "1"}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"ResultsNew", " ", "=", " ", 
    RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"ResultsOld", " ", "=", " ", 
    RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"SNR", " ", "=", " ", "#"}], ";", "\[IndentingNewLine]", 
       RowBox[{"gamma", " ", "=", " ", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"SNR", "/", "10"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"errors", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Smatrix", " ", "=", " ", 
            RowBox[{"RandomChoice", "[", "ExtendedSmats", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"bvector", " ", "=", " ", 
            RowBox[{"RandomChoice", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}], ",", " ", "mm"}], "]"}]}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"chirp", " ", "=", " ", 
            RowBox[{"GenerateChirp", "[", 
             RowBox[{"Smatrix", ",", " ", "bvector"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"tstvec", " ", "=", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"Sqrt", "[", 
               RowBox[{"Nn", "*", "gamma"}], "]"}], "*", "chirp"}], " ", "+", 
             " ", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "I"}], "}"}], ".", 
               RowBox[{"RandomVariate", "[", 
                RowBox[{
                 RowBox[{"NormalDistribution", "[", 
                  RowBox[{"0", ",", "1"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", "Nn"}], "}"}]}], "]"}]}], "/", 
              RowBox[{"Sqrt", "[", "2", "]"}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Sestimate", ",", "bestimate"}], "}"}], "=", 
            RowBox[{"ExtendedDecoder", "[", "tstvec", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Union", "[", 
                RowBox[{"Flatten", "[", 
                 RowBox[{"Sestimate", "-", "Smatrix"}], "]"}], "]"}], "!=", 
               RowBox[{"{", "0", "}"}]}], " ", "||", " ", 
              RowBox[{
               RowBox[{"Union", "[", 
                RowBox[{"bestimate", "-", "bvector"}], "]"}], "!=", 
               RowBox[{"{", "0", "}"}]}]}], ",", 
             RowBox[{"errors", " ", "+=", " ", "1"}]}], "]"}], ";"}], 
          "\[IndentingNewLine]", ")"}], "&"}], "/@", " ", 
        RowBox[{"Range", "[", "drops", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"ResultsNew", ",", " ", 
         RowBox[{"{", 
          RowBox[{"SNR", ",", " ", 
           RowBox[{
            RowBox[{"errors", "/", "drops"}], "//", "N"}]}], "}"}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"errors", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Smatrix", " ", "=", " ", 
            RowBox[{"RandomChoice", "[", "AllBinSymm", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"bvector", " ", "=", " ", 
            RowBox[{"RandomChoice", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}], ",", " ", "mm"}], "]"}]}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"chirp", " ", "=", " ", 
            RowBox[{"GenerateChirp", "[", 
             RowBox[{"Smatrix", ",", " ", "bvector"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"tstvec", " ", "=", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"Sqrt", "[", 
               RowBox[{"Nn", "*", "gamma"}], "]"}], "*", "chirp"}], " ", "+", 
             " ", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "I"}], "}"}], ".", 
               RowBox[{"RandomVariate", "[", 
                RowBox[{
                 RowBox[{"NormalDistribution", "[", 
                  RowBox[{"0", ",", "1"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", "Nn"}], "}"}]}], "]"}]}], "/", 
              RowBox[{"Sqrt", "[", "2", "]"}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "Sestimate", ",", " ", "zleft", ",", " ", "bestimate", ",", " ", 
              "metric"}], "}"}], "=", 
            RowBox[{"BreadthFirstDecoding", "[", 
             RowBox[{"{", 
              RowBox[{"tstvec", ",", " ", 
               RowBox[{"Range", "[", "mm", "]"}], ",", " ", "1", ",", " ", 
               "False"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Union", "[", 
                RowBox[{"Flatten", "[", 
                 RowBox[{"Sestimate", "-", "Smatrix"}], "]"}], "]"}], "!=", 
               RowBox[{"{", "0", "}"}]}], " ", "||", " ", 
              RowBox[{
               RowBox[{"Union", "[", 
                RowBox[{"bestimate", "-", "bvector"}], "]"}], "!=", 
               RowBox[{"{", "0", "}"}]}]}], ",", 
             RowBox[{"errors", " ", "+=", " ", "1"}]}], "]"}], ";"}], 
          "\[IndentingNewLine]", ")"}], "&"}], "/@", " ", 
        RowBox[{"Range", "[", "drops", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"ResultsOld", ",", " ", 
         RowBox[{"{", 
          RowBox[{"SNR", ",", " ", 
           RowBox[{
            RowBox[{"errors", "/", "drops"}], "//", "N"}]}], "}"}]}], "]"}], 
       ";"}], "\[IndentingNewLine]", ")"}], "&"}], "/@", " ", "SNRValues"}], 
   ";"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "ResultsNew", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "ResultsOld", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ResultsNew", ",", " ", "ResultsOld"}], "}"}], ",", " ", 
   RowBox[{"PlotLegends", "->", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Extended codebook\>\"", ",", " ", "\"\<Binary chirp codebook\>\""}],
      "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwlzl1IUwEABeCL5DAbushFazezmjac20KC2TYYg2Qh+eBKyB9km1Pm5rLN
WJh72EqxRChhaSxhzoceKiaopKBXCWnkzzQn1wd/QGqgzZiBMkaRdc/14fC9
HA7nkqlF35BGEEQBE+gapf7xwz+1FdSx5rTDE2cZX0+fSYd37Rb1Ocb2oWM5
czNa6Lv+RQ8fjxCdsDFS1gUn5NWv4L1Z/QBcNL+fh/1vTi7ASSNxAK/Rmawc
LikQMNJd8guwKFwigqcV9/OhZMkrhU/cPDnsS1fegPOxBRVUivZ0cPordRta
6363waiE72H71dQ76N0IDkPXqZZxmNgZWYHU51Uauumna9Dzy7LF7m7us/p7
Jr5BvUmXgD+O4qLzjI/UzyWwaPuKGn5cDmpgnlNcDkef0TWwez1pgL6bY0aY
Mkgt0JoZb4ZRUZYD2p1XWbf3XrbDXP8Qa+utKqEQfwMHufCyXeuAghcPHsJk
hvYv9PWFj6AqbMsiGTOCNdmQ1Chy4FteiIQfyoL5sERDFMDm0J9CmBcZlMKG
xH4xNF38roCy0t07UJkiK2GjS1YFYx29tVAc+lQPuVPFZtjGCTRBXna/Df4H
x3othw==
  "],
 CellLabel->"In[64]:=",ExpressionUUID->"95a65708-afe1-4ff4-9cfd-931185bac996"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"15234.079712`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.861958499726446*^9, 3.861958540492037*^9}, {
   3.861959376328788*^9, 3.861959392485178*^9}, 3.861959439794565*^9, 
   3.861959535305993*^9, 3.8619595676658792`*^9, 3.8619596515751467`*^9, {
   3.861959715249755*^9, 3.861959735799986*^9}, 3.861959800495261*^9, {
   3.861960942119639*^9, 3.8619609612186728`*^9}, {3.861961583389765*^9, 
   3.861961619818956*^9}, 3.861961657475041*^9, 3.8619625815236893`*^9, {
   3.861962738219445*^9, 3.861962748715866*^9}, 3.861962797361134*^9, 
   3.861962827361405*^9, 3.861963118403075*^9, {3.8619631909427633`*^9, 
   3.861963208062305*^9}, {3.861963392878538*^9, 3.861963409472163*^9}, 
   3.861963444958973*^9, 3.861963480397551*^9, 3.8619635111076107`*^9, 
   3.861978707867793*^9},
 CellLabel->"Out[64]=",ExpressionUUID->"a16fe540-569a-40ba-a4cf-9e755919a29f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "10"}], ",", "0.9998311111111111`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "9"}], ",", "0.9996888888888888`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "8"}], ",", "0.9996088888888889`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "7"}], ",", "0.9993688888888889`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "6"}], ",", "0.9990488888888889`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "5"}], ",", "0.9987022222222223`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4"}], ",", "0.9980177777777778`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3"}], ",", "0.9960444444444444`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2"}], ",", "0.9939644444444444`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "0.9894311111111112`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0.9818133333333333`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0.9689155555555555`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.9471377777777777`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0.9117866666666666`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "0.8566755555555555`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "0.7751288888888889`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "0.6657777777777778`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "0.5314044444444445`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "0.3888711111111111`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"9", ",", "0.2501244444444444`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "0.13802666666666666`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"11", ",", "0.06412444444444444`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"12", ",", "0.02312`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"13", ",", "0.00624`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"14", ",", "0.0011466666666666667`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"15", ",", "0.00022222222222222223`"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{3.86197870787527*^9},
 CellLabel->
  "During evaluation of \
In[64]:=",ExpressionUUID->"b7396f0e-bcc7-44ee-b58f-890580eb77ae"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "10"}], ",", "0.9890844444444444`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "9"}], ",", "0.9860977777777777`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "8"}], ",", "0.9813244444444444`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "7"}], ",", "0.9737244444444444`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "6"}], ",", "0.9645066666666666`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "5"}], ",", "0.9490488888888889`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4"}], ",", "0.9261866666666667`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3"}], ",", "0.89344`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2"}], ",", "0.8445333333333334`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "0.7734577777777778`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0.6779911111111111`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0.558`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.4224`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0.28308444444444447`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "0.16045333333333334`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "0.07694222222222222`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "0.027342222222222223`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "0.007617777777777778`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "0.0016888888888888889`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"9", ",", "0.00019555555555555556`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "8.888888888888888`*^-6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"11", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"12", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"13", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"14", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"15", ",", "0.`"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{3.8619787078796663`*^9},
 CellLabel->
  "During evaluation of \
In[64]:=",ExpressionUUID->"3ece10a7-8977-4350-8e3c-07ac8c580959"]
}, Open  ]],

Cell[BoxData[
 TemplateBox[{
   GraphicsBox[{{}, {{{}, {}, {
        Hue[0.67, 0.6, 0.6], 
        Directive[
         PointSize[
          NCache[
           Rational[1, 60], 0.016666666666666666`]], 
         RGBColor[0.368417, 0.506779, 0.709798], 
         AbsoluteThickness[1.6]], 
        LineBox[CompressedData["
1:eJxTTMoPSmViYGCQAmIQDQEqB1bdLr8w9997ewhf6cCmyrre4r8wvsKB6UaX
jp/+A+PLHHCNPVt25ReML3HghoNMgukPGF/kAG/SnZi4rzC+wIGpVj2/Dr2H
8TkOeHJ7zJxxH8ZnONBy6URr3zkY/8P+C/t/52WvhMszFBqsO82cDZe35/L5
ZhjNCJd3OD+p+9Fnv3cw8x2uJntYR+u+hdnv0DnzzK1Hma9h7nOYerZO8vbZ
FzD3O3Bt3GfE6/cU5j+H5Au7njgzPoT532G3qeoK58c3YOHjUJht8pWT6QKU
r+Kwd8rymbdXHYTy1RwOhh9eXpq1AcrXcKjY2fH+yJrpUL6Ww1P1q3ay/ZVQ
vo7D2h3eX8tPBkH5eg5GehOjuhR07QG324IE
         "]]}, {
        Hue[0.9060679774997897, 0.6, 0.6], 
        Directive[
         PointSize[
          NCache[
           Rational[1, 60], 0.016666666666666666`]], 
         RGBColor[0.880722, 0.611041, 0.142051], 
         AbsoluteThickness[1.6]], 
        LineBox[CompressedData["
1:eJxTTMoPSmViYGCQAmIQDQEqB1ge7s6esuy9PYSvdGDLdbe3Mn0wvsKBde9L
WpnSYXyZA309bVoHNGB8iQN8+YdFbe++g/JFDtgvbzo2Ow7GFzjAkpxlEbT4
LZTPcUCAbV41//Q3UD7DgWm9D49ksb2G8j/srwBb8AImz/AzVy1LatNTmLy9
U8LTC0q3H8LkHdxUS5lmcdyGme/g4L3TnE/uEsx+hwlbZ8ru6TwCc5+DnJOC
R82mzTD3OwS7/aqY+X82zH8O9uuPL7toXA/zv8P6HdcWbVsdDQsfh3j37LyD
CzWhfBWHnZXy0/SXPLKD8NUcGFCABhpfC42vg8bXg/MBZjdicQ==
         
         "]]}}}, {{}, {}}}, {
    DisplayFunction -> Identity, DisplayFunction -> Identity, AspectRatio -> 
     NCache[GoldenRatio^(-1), 0.6180339887498948], Axes -> {True, True}, 
     AxesLabel -> {None, None}, AxesOrigin -> {0, 0}, DisplayFunction :> 
     Identity, Frame -> {{False, False}, {False, False}}, 
     FrameLabel -> {{None, None}, {None, None}}, 
     FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
     GridLines -> {None, None}, GridLinesStyle -> Directive[
       GrayLevel[0.5, 0.4]], 
     Method -> {
      "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
       "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
           Identity[
            Part[#, 1]], 
           Identity[
            Part[#, 2]]}& ), "CopiedValueFunction" -> ({
           Identity[
            Part[#, 1]], 
           Identity[
            Part[#, 2]]}& )}}, 
     PlotRange -> {{-10., 15.}, {0, 0.9998311111111111}}, PlotRangeClipping -> 
     True, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.02], 
        Scaled[0.05]}}, Ticks -> {Automatic, Automatic}}], 
   FormBox[
    FormBox[
     TemplateBox[{"\"Extended codebook\"", "\"Binary chirp codebook\""}, 
      "LineLegend", DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #2}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"LineLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", 
                    FractionBox["1", "60"], "]"}], ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.368417, 0.506779, 0.709798]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", 
                    FractionBox["1", "60"], "]"}], ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.880722, 0.611041, 0.142051]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}]}],
              "}"}], ",", 
           RowBox[{"{", 
             RowBox[{#, ",", #2}], "}"}], ",", 
           RowBox[{"LegendMarkers", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"Joined", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{"True", ",", "True"}], "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& ), 
      Editable -> True], TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{{3.861958499726446*^9, 3.861958540492037*^9}, {
   3.861959376328788*^9, 3.861959392485178*^9}, 3.861959439794565*^9, 
   3.861959535305993*^9, 3.8619595676658792`*^9, 3.8619596515751467`*^9, {
   3.861959715249755*^9, 3.861959735799986*^9}, 3.861959800495261*^9, {
   3.861960942119639*^9, 3.8619609612186728`*^9}, {3.861961583389765*^9, 
   3.861961619818956*^9}, 3.861961657475041*^9, 3.8619625815236893`*^9, {
   3.861962738219445*^9, 3.861962748715866*^9}, 3.861962797361134*^9, 
   3.861962827361405*^9, 3.861963118403075*^9, {3.8619631909427633`*^9, 
   3.861963208062305*^9}, {3.861963392878538*^9, 3.861963409472163*^9}, 
   3.861963444958973*^9, 3.861963480397551*^9, 3.8619635111076107`*^9, 
   3.861978708020713*^9},
 CellLabel->"Out[67]=",ExpressionUUID->"12568aa7-a849-49ad-97a6-fb0be9faabe2"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.862021851664535*^9, 3.862021864776095*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"588225e7-5965-4086-8dbe-b89870bd5569"]
}, Open  ]]
},
WindowSize->{1386, 768},
WindowMargins->{{0, Automatic}, {0, Automatic}},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"13.0 for Linux x86 (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"359ae7cd-82de-44d7-84a9-7116cef7a1ce"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 306, 7, 54, "Subsection",ExpressionUUID->"f461c790-49de-4413-931b-d40719c17a7f",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[889, 31, 1940, 52, 298, "Input",ExpressionUUID->"1ba7e596-3ed0-40e6-8839-30538b4f23fd",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[2832, 85, 1005, 16, 23, "Print",ExpressionUUID->"d42755b6-0d95-4359-ba0a-aad6a34f9142",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[3840, 103, 2190, 43, 25, "Print",ExpressionUUID->"625ea918-9ed6-4038-9ac1-0f137d5ba706",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[6033, 148, 1023, 16, 23, "Print",ExpressionUUID->"83a0a57c-21b4-4650-9089-6ffb3232130f",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[7059, 166, 2784, 72, 30, "Print",ExpressionUUID->"b85149de-da3b-41e3-b3d7-2b04a404dced",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[9846, 240, 1117, 18, 23, "Print",ExpressionUUID->"f3b7e79f-eddf-4997-947d-caf118a12e7e",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[10966, 260, 2454, 62, 134, "Input",ExpressionUUID->"04ce83ea-1d79-4930-aa71-e07dd1556658",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[13423, 324, 3547, 79, 151, "Output",ExpressionUUID->"d336739c-6f39-4eb3-bbc3-3f66ff9fb75d",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}, Open  ]],
Cell[CellGroupData[{
Cell[17007, 408, 156, 3, 54, "Subsection",ExpressionUUID->"b8ec32e4-7c90-4d56-a2d8-7943e4e7b8aa"],
Cell[CellGroupData[{
Cell[17188, 415, 4351, 113, 388, "Input",ExpressionUUID->"5581368c-9f69-46ad-a03d-a7117bab89cf"],
Cell[21542, 530, 810, 14, 33, "Output",ExpressionUUID->"43f6847a-8f06-40f6-ba99-4d6896a68a2b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[22401, 550, 156, 3, 54, "Subsection",ExpressionUUID->"fe03d17b-d443-453a-9714-0221186a79c2"],
Cell[CellGroupData[{
Cell[22582, 557, 169, 3, 45, "Subsubsection",ExpressionUUID->"03c61586-da18-4757-88a8-f75fa0f313d5"],
Cell[22754, 562, 5382, 139, 536, "Input",ExpressionUUID->"98a14e7e-f82f-4e87-84fe-aac42208e2e8"],
Cell[28139, 703, 2700, 63, 220, "Input",ExpressionUUID->"6fe6b4a7-d33b-44ca-a436-1b27cc316451"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30876, 771, 193, 3, 45, "Subsubsection",ExpressionUUID->"e4a3f8f8-d77d-4ebd-90bb-ece0f018ed45"],
Cell[31072, 776, 4613, 115, 469, "Input",ExpressionUUID->"0eaa0858-b649-4b1a-b2d4-d64a48e04686"]
}, Closed]],
Cell[CellGroupData[{
Cell[35722, 896, 163, 3, 37, "Subsubsection",ExpressionUUID->"b186a04f-c53b-4a22-bdbc-1a717bc84296"],
Cell[35888, 901, 24911, 519, 2477, "Input",ExpressionUUID->"c05a0ac2-d164-403f-ad37-8fd40ac3b907"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60836, 1425, 188, 3, 45, "Subsubsection",ExpressionUUID->"fc7d9ba2-a645-41c5-8011-28d1f30c6ea6"],
Cell[61027, 1430, 14773, 320, 1061, "Input",ExpressionUUID->"b7d465eb-be74-4b48-858a-39689fbcc7c8"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[75849, 1756, 160, 3, 54, "Subsection",ExpressionUUID->"fcba4a3e-c55c-4b6b-8b3b-21b960e5cb8f"],
Cell[CellGroupData[{
Cell[76034, 1763, 963, 24, 71, "Input",ExpressionUUID->"d479db40-5cd3-457c-882c-4fa00c3337fc"],
Cell[77000, 1789, 1086, 26, 79, "Output",ExpressionUUID->"39573260-86e5-4285-9ae4-b8ed941a9ac5"],
Cell[78089, 1817, 1107, 28, 79, "Output",ExpressionUUID->"93251719-09ae-41b3-aadf-ca7b22fe7899"]
}, Open  ]],
Cell[CellGroupData[{
Cell[79233, 1850, 880, 21, 71, "Input",ExpressionUUID->"b84d3c9c-8cac-4561-a8b9-536ccf8d93fc"],
Cell[80116, 1873, 1087, 26, 79, "Output",ExpressionUUID->"eed34e0b-d4a7-42d9-a85c-79a723112519"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81240, 1904, 339, 8, 29, "Input",ExpressionUUID->"16075d6e-f6e2-415b-afbc-0e6cd5c1c95b"],
Cell[81582, 1914, 491, 7, 33, "Output",ExpressionUUID->"82d07b45-18ce-4469-97d8-de9fac6b29c8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[82110, 1926, 211, 3, 29, "Input",ExpressionUUID->"9309cc1c-20ef-4aa2-9658-c15f16fecdce"],
Cell[82324, 1931, 990, 27, 79, "Output",ExpressionUUID->"61086251-fba5-46d0-b951-b001007954b2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[83351, 1963, 215, 5, 29, "Input",ExpressionUUID->"acc5cd94-fa39-4fe3-be3e-8a8fe2599074"],
Cell[83569, 1970, 414, 6, 33, "Output",ExpressionUUID->"fc7890b9-58df-47ea-9f69-3743e44c3658"]
}, Open  ]],
Cell[83998, 1979, 5549, 145, 412, "Input",ExpressionUUID->"cfb00114-724f-49b7-bc1b-66b8d94f6a60"],
Cell[CellGroupData[{
Cell[89572, 2128, 5272, 134, 484, "Input",ExpressionUUID->"e09ef87e-43f3-4b2a-86fa-eff8b0d4c154"],
Cell[94847, 2264, 850, 24, 95, "Output",ExpressionUUID->"5cd11531-b8a2-4ad7-8613-37715f26615f"],
Cell[95700, 2290, 1053, 18, 28, "Message",ExpressionUUID->"7adf6a16-c803-44b1-81ae-9159919d3c44"],
Cell[96756, 2310, 1125, 19, 28, "Message",ExpressionUUID->"40549bad-41e0-4623-abf9-fee5bf047c15"],
Cell[97884, 2331, 475, 11, 28, "Message",ExpressionUUID->"1b857e46-ac02-4e28-afad-cc5f1507df15"],
Cell[98362, 2344, 389, 9, 28, "Message",ExpressionUUID->"ddbfbb54-ddc7-45ba-9b86-4bc07f114afd"],
Cell[98754, 2355, 509, 11, 28, "Message",ExpressionUUID->"2f4fbb6f-dd7a-4a71-8047-e3ff49774f53"],
Cell[99266, 2368, 512, 11, 28, "Message",ExpressionUUID->"80c3f01b-4592-4b92-b47a-9d0091ed7508"],
Cell[99781, 2381, 453, 10, 28, "Message",ExpressionUUID->"c870ce78-6a5b-4c4d-9471-ae76fd993134"],
Cell[100237, 2393, 932, 17, 28, "Message",ExpressionUUID->"6f6045ec-89e3-4248-a7f0-11b4225b7f6c"],
Cell[101172, 2412, 992, 18, 28, "Message",ExpressionUUID->"c8de1225-3034-459e-9bc4-521017dc2a54"],
Cell[102167, 2432, 1306, 22, 28, "Message",ExpressionUUID->"d7ecd4dc-df7a-46ae-8673-afb56e9c6a45"],
Cell[103476, 2456, 1096, 19, 28, "Message",ExpressionUUID->"b60cd53d-96b2-407d-960c-8c629cf5055e"],
Cell[104575, 2477, 390, 9, 28, "Message",ExpressionUUID->"819164fe-dc0e-45e1-8ef3-c7adf86d6f8a"],
Cell[104968, 2488, 450, 10, 28, "Message",ExpressionUUID->"5b1f0da0-ccc0-4dbf-bfa7-0dfb262e49a6"],
Cell[105421, 2500, 322, 8, 28, "Message",ExpressionUUID->"a5bab238-c578-4381-a9a7-2d37cc2c98ac"],
Cell[105746, 2510, 322, 8, 28, "Message",ExpressionUUID->"babe5412-c0a7-467e-b8aa-d21775f8eb4f"],
Cell[106071, 2520, 322, 8, 28, "Message",ExpressionUUID->"44fa4008-4491-40ef-aa8e-48c76ae767ae"],
Cell[106396, 2530, 448, 10, 28, "Message",ExpressionUUID->"aa67e7c3-7638-49d3-be0e-747f85b3cc96"],
Cell[106847, 2542, 1054, 18, 28, "Message",ExpressionUUID->"37222b7a-fe7c-47ad-bea5-ae48fe5c8ded"],
Cell[107904, 2562, 451, 10, 28, "Message",ExpressionUUID->"a3973774-39d5-4e3d-9547-3fbc65fe6014"],
Cell[108358, 2574, 934, 17, 28, "Message",ExpressionUUID->"df5ed79c-8041-49d5-b223-127c464df171"],
Cell[109295, 2593, 1096, 19, 28, "Message",ExpressionUUID->"f28af790-4d4e-4a59-a6b9-c51e0dbdc3f1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[110428, 2617, 7735, 181, 665, "Input",ExpressionUUID->"95a65708-afe1-4ff4-9cfd-931185bac996"],
Cell[118166, 2800, 915, 14, 33, "Output",ExpressionUUID->"a16fe540-569a-40ba-a4cf-9e755919a29f"],
Cell[CellGroupData[{
Cell[119106, 2818, 2404, 68, 64, "Print",ExpressionUUID->"b7396f0e-bcc7-44ee-b58f-890580eb77ae"],
Cell[121513, 2888, 2321, 68, 66, "Print",ExpressionUUID->"3ece10a7-8977-4350-8e3c-07ac8c580959"]
}, Open  ]],
Cell[123849, 2959, 9008, 199, 251, "Output",ExpressionUUID->"12568aa7-a849-49ad-97a6-fb0be9faabe2"]
}, Open  ]],
Cell[132872, 3161, 171, 2, 29, "Input",ExpressionUUID->"588225e7-5965-4086-8dbe-b89870bd5569"]
}, Open  ]]
}
]
*)

